(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$;b=a.WebSharper=a.WebSharper||{};c=b.WebUSB=b.WebUSB||{};d=c.Sample=c.Sample||{};e=d.Client=d.Client||{};f=b.Operators=b.Operators||{};g=b.Obj=b.Obj||{};h=b.UI=b.UI||{};i=h.Templating=h.Templating||{};j=i.Runtime=i.Runtime||{};k=j.Server=j.Server||{};l=k.TemplateInstance=k.TemplateInstance||{};m=b.Arrays=b.Arrays||{};n=k.ProviderBuilder=k.ProviderBuilder||{};o=h.TemplateHole=h.TemplateHole||{};p=h.Var=h.Var||{};q=k.Handler=k.Handler||{};r=b.Unchecked=b.Unchecked||{};s=a.WebSharper$WebUSB$Sample_Templates=a.WebSharper$WebUSB$Sample_Templates||{};t=h.TemplateHoleModule=h.TemplateHoleModule||{};u=t.Text=t.Text||{};v=t.TextView=t.TextView||{};w=a.StartupCode$WebSharper_WebUSB_Sample$Client=a.StartupCode$WebSharper_WebUSB_Sample$Client||{};x=a.System=a.System||{};y=x.Guid=x.Guid||{};z=t.EventQ=t.EventQ||{};A=b.JavaScript=b.JavaScript||{};B=A.Pervasives=A.Pervasives||{};C=b.Concurrency=b.Concurrency||{};D=A.Promise=A.Promise||{};E=a.EventTarget;F=A.JS=A.JS||{};G=h.Client=h.Client||{};H=G.Templates=G.Templates||{};I=h.Doc=h.Doc||{};J=b.Collections=b.Collections||{};K=J.Dictionary=J.Dictionary||{};L=a.Node;M=a.Object;N=h.Var$1=h.Var$1||{};O=a.WindowOrWorkerGlobalScope;P=C.AsyncBody=C.AsyncBody||{};Q=C.CT=C.CT||{};R=J.HashSet=J.HashSet||{};S=b.Seq=b.Seq||{};T=k.TemplateInitializer=k.TemplateInitializer||{};U=t.VarStr=t.VarStr||{};V=t.VarFloatUnchecked=t.VarFloatUnchecked||{};W=t.VarBool=t.VarBool||{};X=t.VarDateTime=t.VarDateTime||{};Y=t.VarFile=t.VarFile||{};Z=t.VarDomElement=t.VarDomElement||{};_0=h.View=h.View||{};_1=b.Numeric=b.Numeric||{};_2=h.ConcreteVar=h.ConcreteVar||{};_3=h.Snap=h.Snap||{};_4=C.Scheduler=C.Scheduler||{};_5=a.Error;_6=A.NonStandardPromiseRejectionException=A.NonStandardPromiseRejectionException||{};_7=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};_8=J.DictionaryUtil=J.DictionaryUtil||{};_9=b.Enumerator=b.Enumerator||{};_=_9.T=_9.T||{};$=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};ba=h.Docs=h.Docs||{};bb=h.DocElemNode=h.DocElemNode||{};bc=a.CharacterData;bd=h.Abbrev=h.Abbrev||{};be=bd.Fresh=bd.Fresh||{};bf=b.OperationCanceledException=b.OperationCanceledException||{};bg=b.CancellationTokenSource=b.CancellationTokenSource||{};bh=a.Blob;bi=h.Elt=h.Elt||{};bj=a.Element;bk=H.Prepare=H.Prepare||{};bl=b.Slice=b.Slice||{};bm=h.DomUtility=h.DomUtility||{};bn=J.KeyCollection=J.KeyCollection||{};bo=h.An=h.An||{};bp=G.Settings=G.Settings||{};bq=bd.Mailbox=bd.Mailbox||{};br=G.Attrs=G.Attrs||{};bs=br.Dyn=br.Dyn||{};bt=h.Attrs=h.Attrs||{};bu=t.Elt=t.Elt||{};bv=t.Attribute=t.Attribute||{};bw=t.Event=t.Event||{};bx=h.AttrModule=h.AttrModule||{};by=h.AttrProxy=h.AttrProxy||{};bz=t.AfterRender=t.AfterRender||{};bA=t.AfterRenderQ=t.AfterRenderQ||{};bB=b.List=b.List||{};bC=bB.T=bB.T||{};bD=b.Strings=b.Strings||{};bE=h.Array=h.Array||{};bF=h.Updates=h.Updates||{};bG=J.ValueCollection=J.ValueCollection||{};bH=G.Docs=G.Docs||{};bI=bH.RunState=bH.RunState||{};bJ=bH.NodeSet=bH.NodeSet||{};bK=h.Anims=h.Anims||{};bL=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bM=J.HashSetUtil=J.HashSetUtil||{};bN=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bO=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bP=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bQ=h.AppendList=h.AppendList||{};bR=h.DynamicAttrNode=h.DynamicAttrNode||{};bS=b.KeyNotFoundException=b.KeyNotFoundException||{};bT=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bU=h.Easing=h.Easing||{};bV=bd.HashSet=bd.HashSet||{};bW=h.BindVar=h.BindVar||{};bX=h.String=h.String||{};bY=h.CheckedInput=h.CheckedInput||{};bZ=bH.DomNodes=bH.DomNodes||{};b0=b.Char=b.Char||{};b1=b.DateUtil=b.DateUtil||{};b2=b.Lazy=b.Lazy||{};b3=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};b4=b.Queue=b.Queue||{};b5=b.LazyExtensionsProxy=b.LazyExtensionsProxy||{};b6=b5.LazyRecord=b5.LazyRecord||{};b7=a.console;b8=a.Promise;b9=b&&b.Runtime;b_=a.Math;b$=a.Date;e.Main=function(){var ca,cb,cc,cd,ce,cf,cg;ca=(cb=(cc=(cd=(ce=new n.New$1(),(ce.h.push(new v.New("status",e.statusMessage().get_View())),ce)),(cd.h.push(q.EventQ2(cd.k,"connectusb",function(){return cd.i;},function(){var ch;C.StartImmediate((ch=null,C.Delay(function(){return C.Bind(D.AsAsync(e.connectUSB()),function(){return C.Return(null);});})),null);})),cd)),(cc.h.push(q.EventQ2(cc.k,"sendusbdata",function(){return cc.i;},function(){var ch;C.StartImmediate((ch=null,C.Delay(function(){return C.Bind(D.AsAsync(e.sendUSBData()),function(){return C.Return(null);});})),null);})),cc)),(cf=q.CompleteHoles(cb.k,cb.h,[]),(cg=new l.New(cf[1],s.main(cf[0])),cb.i=cg,cg))).get_Doc();H.LoadLocalTemplates("");I.RunById("main",ca);};e.statusMessage=function(){w.$cctor();return w.statusMessage;};e.connectUSB=function(){var ca;function cb(){function cc(){return e.usb().requestDevice({filters:[]}).then(function(ce){return ce.open().then(function(){return ce.selectConfiguration(1).then(function(){return ce.claimInterface(0).then(function(){var cf;e.device().Set(ce);e.statusMessage().Set("Connected to USB device: $"+a.String(e.device().Get().productName));cf=e.device().Get();(function(cg){return cg("USB Device Connected: "+a.String(cf));}(function(cg){b7.log(cg);}));return b8.resolve(null);});});});});}function cd(ce){e.statusMessage().Set("Connection Failed: "+a.String(ce.message));(function(cf){return cf("USB Connection Error: "+a.String(ce));}(function(cf){b7.log(cf);}));return b8.resolve(null);}return new b8(function(ce){ce(cc());})["catch"](function(ce){return cd(D.unwrapExn(ce));});}ca=null;return new b8(function(cc){cc(cb());});};e.sendUSBData=function(){var ca;function cb(){function cc(){var ce;ce=a["eval"]("new TextEncoder()").encode("Hello USB!");return e.device().Get().transferOut(1,ce).then(function(){e.statusMessage().Set("Data sent to USB device.");(function(cf){return cf("Data sent: "+a.String(ce));}(function(cf){b7.log(cf);}));return b8.resolve(null);});}function cd(ce){e.statusMessage().Set("Data transfer failed: "+a.String(ce.message));(function(cf){return cf("USB Data Transfer Error: "+a.String(ce));}(function(cf){b7.log(cf);}));return b8.resolve(null);}return e.device().Get()==null?(e.statusMessage().Set("Please connect a USB device first."),b8.resolve(null)):new b8(function(ce){ce(cc());})["catch"](function(ce){return cd(D.unwrapExn(ce));});}ca=null;return new b8(function(cc){cc(cb());});};e.usb=function(){w.$cctor();return w.usb;};e.device=function(){w.$cctor();return w.device;};f.FailWith=function(ca){throw new _5(ca);};f.KeyValue=function(ca){return[ca.K,ca.V];};f.range=function(ca,cb){var cc;cc=1+cb-ca;return cc<=0?[]:S.init(cc,function(cd){return cd+ca;});};g=b.Obj=b9.Class({Equals:function(ca){return this===ca;},GetHashCode:function(){return -1;}},null,g);g.New=b9.Ctor(function(){},g);l=k.TemplateInstance=b9.Class({get_Doc:function(){return this.doc;},SetAnchorRoot:function(ca){this.anchorRoot=ca;}},g,l);l.New=b9.Ctor(function(ca,cb){g.New.call(this);this.doc=cb;this.allVars=ca.$==0?ca.$0:f.FailWith("Should not happen");this.anchorRoot=null;},l);m.get=function(ca,cb){m.checkBounds(ca,cb);return ca[cb];};m.length=function(ca){return ca.dims===2?ca.length*ca.length:ca.length;};m.checkBounds=function(ca,cb){if(cb<0||cb>=ca.length)f.FailWith("Index was outside the bounds of the array.");};m.set=function(ca,cb,cc){m.checkBounds(ca,cb);ca[cb]=cc;};n=k.ProviderBuilder=b9.Class({},g,n);n.New$1=b9.Ctor(function(){var ca;g.New.call(this);this.i=null;this.k=(ca=y.NewGuid(),a.String(ca));this.h=b9.MarkResizable([]);b9.SetOptional(this,"s",null);},n);o=h.TemplateHole=b9.Class({ForTextView:function(){b7.warn("Content hole filled with attribute data",this.get_Name());return null;},AddAttribute:function(ca,cb){b7.warn("Var hole filled with non-Var data",this.get_Name());},get_AsChoiceView:function(){b7.warn("Attribute value hole filled with non-text data",this.get_Name());return{$:0,$0:""};}},g,o);o.New=b9.Ctor(function(){g.New.call(this);},o);p=h.Var=b9.Class({},g,p);p.New=b9.Ctor(function(){g.New.call(this);},p);q.EventQ2=function(ca,cb,cc,cd){return new z.New(cb,function(ce){return function(cf){var cg;cg=cc();cg.SetAnchorRoot(ce);return cd({Vars:cg,Anchors:cg,Target:ce,Event:cf});};});};q.CompleteHoles=function(ca,cb,cc){var ce,cf,cg,ch,ci;function cd(cj,ck,cl){var cm;return cf.Contains(cj)?null:(cm=r.Equals(ck,0)?T.GetOrAddHoleFor(ca,cj,function(){return new U.New(cj,N.Create$1(""));}):r.Equals(ck,1)?T.GetOrAddHoleFor(ca,cj,function(){return new V.New(cj,N.Create$1(0));}):r.Equals(ck,2)?T.GetOrAddHoleFor(ca,cj,function(){return new W.New(cj,N.Create$1(false));}):r.Equals(ck,3)?T.GetOrAddHoleFor(ca,cj,function(){return new X.New(cj,N.Create$1(-8640000000000000));}):r.Equals(ck,4)?T.GetOrAddHoleFor(ca,cj,function(){return new Y.New(cj,N.Create$1([]));}):r.Equals(ck,5)?T.GetOrAddHoleFor(ca,cj,function(){var cn;cn=self.document.querySelector("[ws-dom="+cj+"]");cn.removeAttribute("ws-dom");return new Z.New(cj,N.Create$1({$:1,$0:cn}));}):f.FailWith("Invalid value type"),(ce.set_Item(cj,cm),{$:1,$0:cm}));}ce=new K.New$5();cf=new R.New$3();cg=_9.Get(cb);try{while(cg.MoveNext()){ch=cg.Current();ci=ch.get_Name();cf.SAdd(ci);ce.set_Item(ci,ch);}}finally{if(typeof cg=="object"&&"Dispose"in cg)cg.Dispose();}return[S.append(cb,m.choose(function(cj){return cd(cj[0],cj[1],cj[2]);},cc)),{$:0,$0:ce}];};r.Equals=function(ca,cb){var cc,cd,ce,cf;if(ca===cb)return true;else{cc=typeof ca;if(cc=="object"){if(ca===null||ca===void 0||cb===null||cb===void 0||!r.Equals(typeof cb,"object"))return false;else if("Equals"in ca)return ca.Equals(cb);else if("Equals"in cb)return false;else if(ca instanceof a.Array&&cb instanceof a.Array)return r.arrayEquals(ca,cb);else if(ca instanceof a.Date&&cb instanceof a.Date)return r.dateEquals(ca,cb);else{cd=[true];for(var cg in ca)if(function(ch){cd[0]=!ca.hasOwnProperty(ch)||cb.hasOwnProperty(ch)&&r.Equals(ca[ch],cb[ch]);return!cd[0];}(cg))break;if(cd[0]){for(var ch in cb)if(function(ci){cd[0]=!cb.hasOwnProperty(ci)||ca.hasOwnProperty(ci);return!cd[0];}(ch))break;}return cd[0];}}else return cc=="function"&&("$Func"in ca?ca.$Func===cb.$Func&&ca.$Target===cb.$Target:"$Invokes"in ca&&"$Invokes"in cb&&r.arrayEquals(ca.$Invokes,cb.$Invokes));}};r.arrayEquals=function(ca,cb){var cc,cd;if(m.length(ca)===m.length(cb)){cc=true;cd=0;while(cc&&cd<m.length(ca)){!r.Equals(m.get(ca,cd),m.get(cb,cd))?cc=false:void 0;cd=cd+1;}return cc;}else return false;};r.dateEquals=function(ca,cb){return ca.getTime()===cb.getTime();};r.Hash=function(ca){var cb;cb=typeof ca;return cb=="function"?0:cb=="boolean"?ca?1:0:cb=="number"?ca:cb=="string"?r.hashString(ca):cb=="object"?ca==null?0:ca instanceof a.Array?r.hashArray(ca):r.hashObject(ca):0;};r.hashString=function(ca){var cb,cc,cd;if(ca===null)return 0;else{cb=5381;for(cc=0,cd=ca.length-1;cc<=cd;cc++)cb=r.hashMix(cb,ca[cc].charCodeAt());return cb;}};r.hashArray=function(ca){var cb,cc,cd;cb=-34948909;for(cc=0,cd=m.length(ca)-1;cc<=cd;cc++)cb=r.hashMix(cb,r.Hash(m.get(ca,cc)));return cb;};r.hashObject=function(ca){var cb,cc;if("GetHashCode"in ca)return ca.GetHashCode();else{cb=[0];for(var cd in ca)if(function(ce){cb[0]=r.hashMix(r.hashMix(cb[0],r.hashString(ce)),r.Hash(ca[ce]));return false;}(cd))break;return cb[0];}};r.hashMix=function(ca,cb){return(ca<<5)+ca+cb;};r.Compare=function(ca,cb){var cc,cd,ce,cf,cg,ch;if(ca===cb)return 0;else{cd=typeof ca;switch(cd=="function"?1:cd=="boolean"?2:cd=="number"?2:cd=="string"?2:cd=="object"?3:0){case 0:return typeof cb=="undefined"?0:-1;case 1:return f.FailWith("Cannot compare function values.");case 2:return ca<cb?-1:1;case 3:if(ca===null)ce=-1;else if(cb===null)ce=1;else if("CompareTo"in ca)ce=ca.CompareTo(cb);else if("CompareTo0"in ca)ce=ca.CompareTo0(cb);else if(ca instanceof a.Array&&cb instanceof a.Array)ce=r.compareArrays(ca,cb);else if(ca instanceof a.Date&&cb instanceof a.Date)ce=r.compareDates(ca,cb);else{cf=[0];for(var ci in ca)if(function(cj){return!ca.hasOwnProperty(cj)?false:!cb.hasOwnProperty(cj)?(cf[0]=1,true):(cf[0]=r.Compare(ca[cj],cb[cj]),cf[0]!==0);}(ci))break;if(cf[0]===0){for(var cj in cb)if(function(ck){return!cb.hasOwnProperty(ck)?false:!ca.hasOwnProperty(ck)&&(cf[0]=-1,true);}(cj))break;}ce=cf[0];}return ce;}}};r.compareArrays=function(ca,cb){var cc,cd;if(m.length(ca)<m.length(cb))return -1;else if(m.length(ca)>m.length(cb))return 1;else{cc=0;cd=0;while(cc===0&&cd<m.length(ca)){cc=r.Compare(m.get(ca,cd),m.get(cb,cd));cd=cd+1;}return cc;}};r.compareDates=function(ca,cb){return r.Compare(ca.getTime(),cb.getTime());};s.main=function(ca){H.LoadLocalTemplates("index");return ca?H.NamedTemplate("index",{$:1,$0:"main"},ca):void 0;};u=t.Text=b9.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;},get_AsChoiceView:function(){return{$:0,$0:this.fillWith};}},o,u);u.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},u);v=t.TextView=b9.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:this.fillWith};},get_AsChoiceView:function(){return{$:1,$0:this.fillWith};}},o,v);v.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},v);w.$cctor=function(){w.$cctor=a.ignore;w.statusMessage=N.Create$1("Waiting for connection...");w.device=N.Create$1(void 0);w.usb=self.navigator.usb;};y.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(ca){var cb,cc;cb=b_.random()*16|0;cc=ca=="x"?cb:cb&3|8;return cc.toString(16);});};z=t.EventQ=b9.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},o,z);z.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},z);B.NewFromSeq=function(ca){var cb,cc,cd;cb={};cc=_9.Get(ca);try{while(cc.MoveNext()){cd=cc.Current();cb[cd[0]]=cd[1];}}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}return cb;};C.Delay=function(ca){return function(cb){try{(ca(null))(cb);}catch(cc){cb.k({$:1,$0:cc});}};};C.Bind=function(ca,cb){return C.checkCancel(function(cc){ca(P.New(function(cd){var ce;if(cd.$==0){ce=cd.$0;C.scheduler().Fork(function(){try{(cb(ce))(cc);}catch(cf){cc.k({$:1,$0:cf});}});}else C.scheduler().Fork(function(){cc.k(cd);});},cc.ct));});};C.Return=function(ca){return function(cb){cb.k({$:0,$0:ca});};};C.StartImmediate=function(ca,cb){var cc,cd;cc=(cd=(C.defCTS())[0],cb==null?cd:cb.$0);if(!cc.c)ca(P.New(function(ce){if(ce.$==1)C.UncaughtAsyncError(ce.$0);},cc));};C.checkCancel=function(ca){return function(cb){if(cb.ct.c)C.cancel(cb);else ca(cb);};};C.defCTS=function(){_7.$cctor();return _7.defCTS;};C.UncaughtAsyncError=function(ca){b7.log("WebSharper: Uncaught asynchronous exception",ca);};C.cancel=function(ca){ca.k({$:2,$0:new bf.New(ca.ct)});};C.scheduler=function(){_7.$cctor();return _7.scheduler;};C.FromContinuations=function(ca){return function(cb){var cc;function cd(ce){if(cc[0])f.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{cc[0]=true;C.scheduler().Fork(ce);}}cc=[false];ca(function(ce){cd(function(){cb.k({$:0,$0:ce});});},function(ce){cd(function(){cb.k({$:1,$0:ce});});},function(ce){cd(function(){cb.k({$:2,$0:ce});});});};};C.Zero=function(){_7.$cctor();return _7.Zero;};C.Start=function(ca,cb){var cc,cd;cc=(cd=(C.defCTS())[0],cb==null?cd:cb.$0);C.scheduler().Fork(function(){if(!cc.c)ca(P.New(function(ce){if(ce.$==1)C.UncaughtAsyncError(ce.$0);},cc));});};D.AsAsync=function(ca){return C.FromContinuations(function(cb,cc){ca.then(cb,function(cd){return cc(D.unwrapExn(cd));});});};D.unwrapExn=function(ca){return ca instanceof _5?ca:new _6.New(ca);};F.GetFieldValues=function(ca){var cb,cc;cb=[];for(var cd in ca)cb.push(ca[cd]);return cb;};H.LoadLocalTemplates=function(ca){!H.LocalTemplatesLoaded()?(H.set_LocalTemplatesLoaded(true),H.LoadNestedTemplates(self.document.body,"")):void 0;H.LoadedTemplates().set_Item(ca,H.LoadedTemplateFile(""));};H.NamedTemplate=function(ca,cb,cc){var cd,ce;cd=(ce=null,[H.LoadedTemplateFile(ca).TryGetValue(cb==null?"":cb.$0,{get:function(){return ce;},set:function(cf){ce=cf;}}),ce]);return cd[0]?H.ChildrenTemplate(cd[1].cloneNode(true),cc):(b7.warn("Local template doesn't exist",cb),I.get_Empty());};H.LocalTemplatesLoaded=function(){$.$cctor();return $.LocalTemplatesLoaded;};H.set_LocalTemplatesLoaded=function(ca){$.$cctor();$.LocalTemplatesLoaded=ca;};H.LoadNestedTemplates=function(ca,cb){var cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx;function cc(cy){var cz,cA;if(!cd.ContainsKey(cy)){cz=(cA=null,[ce.TryGetValue(cy,{get:function(){return cA;},set:function(cB){cA=cB;}}),cA]);if(cz[0]){cx.SAdd(cy);ce.RemoveKey(cy);H.PrepareTemplateStrict(cb,{$:1,$0:cy},cz[1],{$:1,$0:cc});}else b7.warn(cx.Contains(cy)?"Encountered loop when instantiating "+cy:"Local template does not exist: "+cy);}}cd=H.LoadedTemplateFile(cb);ce=new K.New$5();cf=ca.querySelectorAll("[ws-template]");for(cg=0,ch=cf.length-1;cg<=ch;cg++){ci=cf[cg];cj=ci.getAttribute("ws-template").toLowerCase();ci.removeAttribute("ws-template");ce.set_Item(cj,H.FakeRootSingle(ci));}ck=ca.querySelectorAll("[ws-children-template]");for(cl=0,cm=ck.length-1;cl<=cm;cl++){cn=ck[cl];co=cn.getAttribute("ws-children-template").toLowerCase();cn.removeAttribute("ws-children-template");ce.set_Item(co,H.FakeRoot(cn));}cp=ca.querySelectorAll("template[id]");for(cq=0,cr=cp.length-1;cq<=cr;cq++){cs=cp[cq];ce.set_Item(cs.getAttribute("id").toLowerCase(),H.FakeRootFromHTMLTemplate(cs));}ct=ca.querySelectorAll("template[name]");for(cu=0,cv=ct.length-1;cu<=cv;cu++){cw=ct[cu];ce.set_Item(cw.getAttribute("name").toLowerCase(),H.FakeRootFromHTMLTemplate(cw));}cx=new R.New$3();while(ce.count>0)cc(S.head(ce.Keys()));};H.LoadedTemplates=function(){$.$cctor();return $.LoadedTemplates;};H.LoadedTemplateFile=function(ca){var cb,cc,cd;cb=(cc=null,[H.LoadedTemplates().TryGetValue(ca,{get:function(){return cc;},set:function(ce){cc=ce;}}),cc]);return cb[0]?cb[1]:(cd=new K.New$5(),(H.LoadedTemplates().set_Item(ca,cd),cd));};H.ChildrenTemplate=function(ca,cb){var cc,cd,ce,cf,cg;cc=H.InlineTemplate(ca,S.append(cb,H.GlobalHoles().Values()));cd=cc[1];ce=cc[0];cf=ce.Els;return!r.Equals(cf,null)&&cf.length===1&&(m.get(cf,0)instanceof L&&(r.Equals(m.get(cf,0).nodeType,L.ELEMENT_NODE)&&(cg=m.get(cf,0),true)))?bi.TreeNode(ce,cd):I.Mk({$:6,$0:ce},cd);};H.FakeRootSingle=function(ca){var cb,cc,cd,ce;ca.removeAttribute("ws-template");cb=ca.getAttribute("ws-replace");if(cb==null);else{ca.removeAttribute("ws-replace");cc=ca.parentNode;r.Equals(cc,null)?void 0:(cd=self.document.createElement(ca.tagName),cd.setAttribute("ws-replace",cb),cc.replaceChild(cd,ca));}ce=self.document.createElement("div");ce.appendChild(ca);return ce;};H.FakeRoot=function(ca){var cb;cb=self.document.createElement("div");while(ca.hasChildNodes())cb.appendChild(ca.firstChild);return cb;};H.FakeRootFromHTMLTemplate=function(ca){var cb,cc,cd,ce;cb=self.document.createElement("div");cc=ca.content;for(cd=0,ce=cc.childNodes.length-1;cd<=ce;cd++)cb.appendChild(cc.childNodes[cd].cloneNode(true));return cb;};H.PrepareTemplateStrict=function(ca,cb,cc,cd){var ce,cf;function cg(cm,cn){var co,cp,cq,cr,cs,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO;function ct(cP){}while(true)switch(cm){case 0:if(cn!==null){co=cn.nextSibling;if(r.Equals(cn.nodeType,L.TEXT_NODE))bk.convertTextNode(cn);else if(r.Equals(cn.nodeType,L.ELEMENT_NODE))ci(cn);cn=co;}else return null;break;case 1:cu=bl.string(cn.nodeName,{$:1,$0:3},null).toLowerCase();cv=(cp=cu.indexOf("."),cp===-1?[ca,cu]:[bl.string(cu,null,{$:1,$0:cp-1}),bl.string(cu,{$:1,$0:cp+1},null)]);cw=cv[1];cx=cv[0];if(cx!=""&&!H.LoadedTemplates().ContainsKey(cx))return bk.failNotLoaded(cw);else{if(cx==""&&cd!=null)cd.$0(cw);cy=H.LoadedTemplates().Item(cx);if(!cy.ContainsKey(cw))return bk.failNotLoaded(cw);else{cz=cy.Item(cw);cA=cz.cloneNode(true);cB=new R.New$3();cC=new K.New$5();cD=cn.attributes;for(cE=0,cF=cD.length-1;cE<=cF;cE++){cG=cD.item(cE).name.toLowerCase();cC.set_Item(cG,(cH=cD.item(cE).nodeValue,cH==""?cG:cH.toLowerCase()));if(!cB.SAdd(cG))b7.warn("Hole mapped twice",cG);}for(cI=0,cJ=cn.childNodes.length-1;cI<=cJ;cI++){cK=cn.childNodes[cI];if(r.Equals(cK.nodeType,L.ELEMENT_NODE))!cB.SAdd(cK.nodeName.toLowerCase())?b7.warn("Hole filled twice",cw):void 0;}cL=cn.childNodes.length===1&&r.Equals(cn.firstChild.nodeType,L.TEXT_NODE);if(cL){cr=bk.fillTextHole(cA,cn.firstChild.textContent,cw);((function(cP){return function(cQ){if(cQ!=null)cP(cQ.$0);};}((cs=function(cP){return function(cQ){return cP.SAdd(cQ);};}(cB),function(cP){return ct(cs(cP));})))(cr));}bk.removeHolesExcept(cA,cB);if(!cL){for(cM=0,cN=cn.childNodes.length-1;cM<=cN;cM++){cO=cn.childNodes[cM];if(r.Equals(cO.nodeType,L.ELEMENT_NODE))cO.hasAttributes()?bk.fillInstanceAttrs(cA,cO):ch(cA,cO);}}bk.mapHoles(cA,cC);bk.fill(cA,cn.parentNode,cn);cn.parentNode.removeChild(cn);return;}}break;}}function ch(cm,cn){var co,cp,cr,cs;function cq(ct,cu){var cv;if(cr=="title"&&cn.hasChildNodes()){cv=bm.ParseHTMLIntoFakeRoot(cn.textContent);cn.removeChild(cn.firstChild);while(cv.hasChildNodes())cn.appendChild(cv.firstChild);}else null;ci(cn);return bk.fill(cn,ct,cu);}cr=cn.nodeName.toLowerCase();H.foreachNotPreserved(cm,"[ws-attr-holes]",function(ct){var cu,cv,cw,cx,cy;cu=bD.SplitChars(ct.getAttribute("ws-attr-holes"),[" "],1);for(cv=0,cw=cu.length-1;cv<=cw;cv++){cx=m.get(cu,cv);ct.setAttribute(cx,(cy=new a.RegExp("\\${"+cr+"}","ig"),ct.getAttribute(cx).replace(cy,cn.textContent)));}});cs=cm.querySelector("[ws-hole="+cr+"]");if(r.Equals(cs,null)){co=cm.querySelector("[ws-replace="+cr+"]");return r.Equals(co,null)?(cp=cm.querySelector("slot[name="+cr+"]"),cm.tagName.toLowerCase()=="template"?(cq(cp.parentNode,cp),void cp.parentNode.removeChild(cp)):null):(cq(co.parentNode,co),void co.parentNode.removeChild(co));}else{while(cs.hasChildNodes())cs.removeChild(cs.lastChild);cs.removeAttribute("ws-hole");return cq(cs,null);}}function ci(cm){if(!cm.hasAttribute("ws-preserve"))if(bD.StartsWith(cm.nodeName.toLowerCase(),"ws-"))ck(cm);else{bk.convertAttrs(cm);cj(cm.firstChild);}}function cj(cm){return cg(0,cm);}function ck(cm){return cg(1,cm);}function cl(cm){var cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy;while(true){cn=cm.querySelector("[ws-template]");if(r.Equals(cn,null)){co=cm.querySelector("[ws-children-template]");if(r.Equals(co,null)){cp=cm.querySelectorAll("template[id]");for(cq=1,cr=cp.length-1;cq<=cr;cq++){cs=cp[cq];if(ce.Contains(cs));else{H.PrepareTemplateStrict(ca,{$:1,$0:cs.getAttribute("id")},cs,null);ce.SAdd(cs);}}ct=cm.querySelectorAll("template[name]");for(cu=1,cv=ct.length-1;cu<=cv;cu++){cw=ct[cu];if(ce.Contains(cw));else{H.PrepareTemplateStrict(ca,{$:1,$0:cw.getAttribute("name")},cw,null);ce.SAdd(cw);}}return null;}else{cx=co.getAttribute("ws-children-template");co.removeAttribute("ws-children-template");H.PrepareTemplateStrict(ca,{$:1,$0:cx},co,null);cm=cm;}}else{cy=cn.getAttribute("ws-template");(H.PrepareSingleTemplate(ca,{$:1,$0:cy},cn))(null);cm=cm;}}}ce=new R.New$3();cf=(cb==null?"":cb.$0).toLowerCase();H.LoadedTemplateFile(ca).set_Item(cf,cc);if(cc.hasChildNodes()){cl(cc);cj(cc.firstChild);}};H.InlineTemplate=function(ca,cb){var cc,cd,ce,cf,cg,ck,cl,cm,cn,co,cp,cq;function ch(cr,cs){var ct,cu,cv;ct=bt.Insert(cr,cs);cl.push(bt.Updates(ct));cm.push([cr,ct]);cu=b9.GetOptional(ct.OnAfterRender);return cu==null?null:(cv=cu.$0,void cn.push(function(){cv(cr);}));}function ci(cr){var cs,ct,cu,cv;cs=(ct=null,[co.TryGetValue(cr,{get:function(){return ct;},set:function(cw){ct=cw;}}),ct]);return cs[0]?(cu=cs[1],cu instanceof bu?{$:1,$0:cu.get_Value()}:cu instanceof u?{$:1,$0:I.TextNode(cu.get_Value())}:(cv=cu.ForTextView(),cv==null?null:{$:1,$0:I.TextView(cv.$0)})):null;}function cj(){H.foreachNotPreservedwsDOM("[ws-dom]",function(cr){var cs,ct,cu,cv,cw,cx,cy;cs=(ct=null,[co.TryGetValue(cr.getAttribute("ws-dom").toLowerCase(),{get:function(){return ct;},set:function(cz){ct=cz;}}),ct]);if(cs[0]){cu=cs[1];cu instanceof Z?(cv=cu.get_Value(),cr.removeAttribute("ws-dom"),cw=cr,cx=new a.MutationObserver(function(cz,cA){m.iter(function(cB){function cC(cD,cE,cF,cG){if(cD===cw&&cB.addedNodes.length!==1){cv.SetFinal(null);cA.disconnect();}}cB.removedNodes.forEach(b9.CreateFuncWithArgs(function(cD){return cC(cD[0],cD[1],cD[2],cD[3]);}),null);},cz);}),cr.parentElement!==null?cx.observe(cr.parentElement,(cy={},cy.childList=true,cy)):void 0,cv.Set({$:1,$0:cr}),_0.Sink(function(cz){var cA;if(cz!=null&&cz.$==1){cA=cz.$0;if(cw===cA);else{cw.replaceWith.apply(cw,[cA]);cw=cA;}}else{cw.remove();cx.disconnect();}},cv.get_View())):void 0;}});}ck=[];cl=[];cm=[];cn=[];co=new K.New$5();cp=_9.Get(cb);try{while(cp.MoveNext()){cq=cp.Current();co.set_Item(cq.get_Name(),cq);}}finally{if(typeof cp=="object"&&"Dispose"in cp)cp.Dispose();}cc=bm.ChildrenArray(ca);H.foreachNotPreserved(ca,"[ws-hole]",function(cr){var cs,ct,cu;cu=cr.getAttribute("ws-hole");cr.removeAttribute("ws-hole");while(cr.hasChildNodes())cr.removeChild(cr.lastChild);cs=ci(cu);if(cs!=null&&cs.$==1){ct=cs.$0;ba.LinkElement(cr,ct.docNode);ck.push(bb.New(bt.Empty(cr),ct.docNode,null,cr,be.Int(),null));cl.push(ct.updates);}});H.foreachNotPreserved(ca,"[ws-replace]",function(cr){var cs,ct,cu,cv,cw,cx;cs=ci(cr.getAttribute("ws-replace"));if(cs!=null&&cs.$==1){ct=cs.$0;cu=cr.parentNode;cv=self.document.createTextNode("");cu.replaceChild(cv,cr);cw=ba.InsertBeforeDelim(cv,ct.docNode);cx=m.tryFindIndex(function(cy){return cr===cy;},cc);cx==null?void 0:m.set(cc,cx.$0,ct.docNode);ck.push(bb.New(bt.Empty(cu),ct.docNode,{$:1,$0:[cw,cv]},cu,be.Int(),null));cl.push(ct.updates);}});cd=false;H.foreachNotPreserved(ca,"slot",function(cr){var cs,ct,cu,cv;cu=cr.getAttribute("name");cv=cu==""||cu==null?"default":cu.toLowerCase();if(cd&&cv=="default"||!r.Equals(ca.parentElement,null))void 0;else{while(cr.hasChildNodes())cr.removeChild(cr.lastChild);if(cv=="default")cd=true;cs=ci(cv);if(cs!=null&&cs.$==1){ct=cs.$0;ba.LinkElement(cr,ct.docNode);ck.push(bb.New(bt.Empty(cr),ct.docNode,null,cr,be.Int(),null));cl.push(ct.updates);}}});H.foreachNotPreserved(ca,"[ws-attr]",function(cr){var cs,ct,cu,cv;cs=cr.getAttribute("ws-attr");cr.removeAttribute("ws-attr");ct=(cu=null,[co.TryGetValue(cs,{get:function(){return cu;},set:function(cw){cu=cw;}}),cu]);if(ct[0]){cv=ct[1];cv instanceof bv?ch(cr,cv.get_Value()):b7.warn("Attribute hole filled with non-attribute data",cs);}});H.foreachNotPreserved(ca,"[ws-on]",function(cr){ch(cr,by.Concat(m.choose(function(cs){var ct,cu,cv,cw;ct=bD.SplitChars(cs,[":"],1);cu=(cv=null,[co.TryGetValue(m.get(ct,1),{get:function(){return cv;},set:function(cx){cv=cx;}}),cv]);return cu[0]?(cw=cu[1],cw instanceof bw?{$:1,$0:bx.Handler(m.get(ct,0),cw.get_Value())}:cw instanceof z?{$:1,$0:by.Handler(m.get(ct,0),cw.get_Value())}:(b7.warn("Event hole on"+m.get(ct,0)+" filled with non-event data",m.get(ct,1)),null)):null;},bD.SplitChars(cr.getAttribute("ws-on"),[" "],1))));cr.removeAttribute("ws-on");});H.foreachNotPreserved(ca,"[ws-onafterrender]",function(cr){var cs,ct,cu,cv;cs=cr.getAttribute("ws-onafterrender");ct=(cu=null,[co.TryGetValue(cs,{get:function(){return cu;},set:function(cw){cu=cw;}}),cu]);if(ct[0]){cv=ct[1];cv instanceof bz?(cr.removeAttribute("ws-onafterrender"),ch(cr,bx.OnAfterRender(cv.get_Value()))):cv instanceof bA?(cr.removeAttribute("ws-onafterrender"),ch(cr,bx.OnAfterRender(cv.get_Value()))):b7.warn("onafterrender hole filled with non-onafterrender data",cs);}});H.foreachNotPreserved(ca,"[ws-var]",function(cr){var cs,ct,cu;cs=cr.getAttribute("ws-var");cr.removeAttribute("ws-var");ct=(cu=null,[co.TryGetValue(cs,{get:function(){return cu;},set:function(cv){cu=cv;}}),cu]);if(ct[0])ct[1].AddAttribute(function(cv){return function(cw){return ch(cv,cw);};},cr);});H.foreachNotPreserved(ca,"[ws-attr-holes]",function(cr){var cs,ct,cu,cv;cs=new a.RegExp(H.TextHoleRE(),"g");ct=bD.SplitChars(cr.getAttribute("ws-attr-holes"),[" "],1);cr.removeAttribute("ws-attr-holes");for(cu=0,cv=ct.length-1;cu<=cv;cu++)(function(){var cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI;cF=m.get(ct,cu);cG=cr.getAttribute(cF);cw=null;cx=0;cH=[];while(cw=cs.exec(cG),cw!==null){cI=bl.string(cG,{$:1,$0:cx},{$:1,$0:cs.lastIndex-m.get(cw,0).length-1});cx=cs.lastIndex;cH.push([cI,m.get(cw,1)]);}cz=bl.string(cG,{$:1,$0:cx},null);cs.lastIndex=0;cA=m.foldBack(function(cJ,cK){return(function(cL){var cM,cN;cM=cL[0];cN=cL[1];return function(cO){var cP,cQ,cR,cS,cT;cP=cO[0];cQ=cO[1];cR=(cS=(cT=null,[co.TryGetValue(cN,{get:function(){return cT;},set:function(cU){cT=cU;}}),cT]),cS[0]?cS[1].get_AsChoiceView():{$:0,$0:""});return cR.$==1?[cM,new bC({$:1,$0:cP==""?cR.$0:_0.Map(function(cU){return cU+cP;},cR.$0),$1:cQ})]:[cM+cR.$0+cP,cQ];};}(cJ))(cK);},cH,[cz,bC.Empty]);return ch(cr,cA[1].$==1?cA[1].$1.$==1?cA[1].$1.$1.$==1?cA[1].$1.$1.$1.$==0?(cB=cA[0],bx.Dynamic(cF,_0.Map3(function(cJ,cK,cL){return cB+cJ+cK+cL;},cA[1].$0,cA[1].$1.$0,cA[1].$1.$1.$0))):(cC=cA[0],bx.Dynamic(cF,_0.Map(function(cJ){return cC+bD.concat("",cJ);},_0.Sequence(cA[1])))):(cD=cA[0],bx.Dynamic(cF,_0.Map2(function(cJ,cK){return cD+cJ+cK;},cA[1].$0,cA[1].$1.$0))):cA[0]==""?bx.Dynamic(cF,cA[1].$0):(cE=cA[0],bx.Dynamic(cF,_0.Map(function(cJ){return cE+cJ;},cA[1].$0))):by.Create(cF,cA[0]));}());});return[b9.DeleteEmptyFields({Els:cc,Dirty:true,Holes:ck,Attrs:cm,Render:(ce=cn.length==0?{$:1,$0:function(){cj();}}:{$:1,$0:function(cr){cj();m.iter(function(cs){cs(cr);},cn);}},ce?ce.$0:void 0),El:(cf=!r.Equals(cc,null)&&cc.length===1&&(m.get(cc,0)instanceof L&&(m.get(cc,0)instanceof bj&&(cg=m.get(cc,0),true)))?{$:1,$0:cg}:null,cf?cf.$0:void 0)},["Render","El"]),bE.TreeReduce(_0.Const(),_0.Map2Unit,cl)];};H.GlobalHoles=function(){$.$cctor();return $.GlobalHoles;};H.foreachNotPreserved=function(ca,cb,cc){bm.IterSelector(ca,cb,function(cd){if(cd.closest("[ws-preserve]")==null)cc(cd);});};H.PrepareSingleTemplate=function(ca,cb,cc){var cd;cd=H.FakeRootSingle(cc);return function(ce){H.PrepareTemplateStrict(ca,cb,cd,ce);};};H.foreachNotPreservedwsDOM=function(ca,cb){bm.IterSelectorDoc(ca,function(cc){if(cc.closest("[ws-preserve]")==null)cb(cc);});};H.TextHoleRE=function(){$.$cctor();return $.TextHoleRE;};I=h.Doc=b9.Class({},g,I);I.RunById=function(ca,cb){var cc;cc=self.document.getElementById(ca);if(r.Equals(cc,null))f.FailWith("invalid id: "+ca);else I.Run(cc,cb);};I.Run=function(ca,cb){ba.LinkElement(ca,cb.docNode);I.RunInPlace(false,ca,cb);};I.get_Empty=function(){return I.Mk(null,_0.Const());};I.RunInPlace=function(ca,cb,cc){var cd;cd=ba.CreateRunState(cb,cc.docNode);_0.Sink(bo.get_UseAnimations()||bp.BatchUpdatesEnabled()?bq.StartProcessor(ba.PerformAnimatedUpdate(ca,cd,cc.docNode)):function(){ba.PerformSyncUpdate(ca,cd,cc.docNode);},cc.updates);};I.Mk=function(ca,cb){return new I.New(ca,cb);};I.TextNode=function(ca){return I.Mk({$:5,$0:self.document.createTextNode(ca)},_0.Const());};I.TextView=function(ca){var cb;cb=ba.CreateTextNode();return I.Mk({$:4,$0:cb},_0.Map(function(cc){ba.UpdateTextNode(cb,cc);},ca));};I.New=b9.Ctor(function(ca,cb){g.New.call(this);this.docNode=ca;this.updates=cb;},I);K=J.Dictionary=b9.Class({set_Item:function(ca,cb){this.set(ca,cb);},set:function(ca,cb){var cc,cd,ce,cf;cc=this;cd=this.hash(ca);ce=this.data[cd];if(ce==null){this.count=this.count+1;this.data[cd]=new a.Array({K:ca,V:cb});}else{cf=m.tryFindIndex(function(cg){return cc.equals.apply(null,[(f.KeyValue(cg))[0],ca]);},ce);cf==null?(this.count=this.count+1,ce.push({K:ca,V:cb})):ce[cf.$0]={K:ca,V:cb};}},TryGetValue:function(ca,cb){var cc,cd,ce;cc=this;cd=this.data[this.hash(ca)];return cd==null?false:(ce=m.tryPick(function(cf){var cg;cg=f.KeyValue(cf);return cc.equals.apply(null,[cg[0],ca])?{$:1,$0:cg[1]}:null;},cd),ce!=null&&ce.$==1&&(cb.set(ce.$0),true));},ContainsKey:function(ca){var cb,cc;cb=this;cc=this.data[this.hash(ca)];return cc==null?false:m.exists(function(cd){return cb.equals.apply(null,[(f.KeyValue(cd))[0],ca]);},cc);},RemoveKey:function(ca){return this.remove(ca);},Keys:function(){return new bn.New(this);},GetEnumerator:function(){return _9.Get0(m.concat(F.GetFieldValues(this.data)));},Values:function(){return new bG.New(this);},remove:function(ca){var cb,cc,cd,ce;cb=this;cc=this.hash(ca);cd=this.data[cc];return cd==null?false:(ce=m.filter(function(cf){return!cb.equals.apply(null,[(f.KeyValue(cf))[0],ca]);},cd),m.length(ce)<cd.length&&(this.count=this.count-1,this.data[cc]=ce,true));},Item:function(ca){return this.get(ca);},get:function(ca){var cb,cc;cb=this;cc=this.data[this.hash(ca)];return cc==null?_8.notPresent():m.pick(function(cd){var ce;ce=f.KeyValue(cd);return cb.equals.apply(null,[ce[0],ca])?{$:1,$0:ce[1]}:null;},cc);}},g,K);K.New$5=b9.Ctor(function(){K.New$6.call(this,[],r.Equals,r.Hash);},K);K.New$6=b9.Ctor(function(ca,cb,cc){var cd,ce;g.New.call(this);this.equals=cb;this.hash=cc;this.count=0;this.data=[];cd=_9.Get(ca);try{while(cd.MoveNext()){ce=cd.Current();this.set(ce.K,ce.V);}}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}},K);N=h.Var$1=b9.Class({},g,N);N.Create$1=function(ca){return new _2.New(false,_3.New({$:2,$0:ca,$1:[]}),ca);};P.New=function(ca,cb){return{k:ca,ct:cb};};Q.New=function(ca,cb){return{c:ca,r:cb};};R=J.HashSet=b9.Class({SAdd:function(ca){return this.add(ca);},Contains:function(ca){var cb;cb=this.data[this.hash(ca)];return cb==null?false:this.arrContains(ca,cb);},add:function(ca){var cb,cc;cb=this.hash(ca);cc=this.data[cb];return cc==null?(this.data[cb]=[ca],this.count=this.count+1,true):this.arrContains(ca,cc)?false:(cc.push(ca),this.count=this.count+1,true);},arrContains:function(ca,cb){var cc,cd,ce,cf;cc=true;cd=0;cf=cb.length;while(cc&&cd<cf)if(this.equals.apply(null,[cb[cd],ca]))cc=false;else cd=cd+1;return!cc;},GetEnumerator:function(){return _9.Get(bM.concat(this.data));},ExceptWith:function(ca){var cb;cb=_9.Get(ca);try{while(cb.MoveNext())this.Remove(cb.Current());}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}},Count:function(){return this.count;},IntersectWith:function(ca){var cb,cc,cd,ce,cf;cb=new R.New$4(ca,this.equals,this.hash);cc=bM.concat(this.data);for(cd=0,ce=cc.length-1;cd<=ce;cd++){cf=cc[cd];if(!cb.Contains(cf))this.Remove(cf);}},Remove:function(ca){var cb;cb=this.data[this.hash(ca)];return cb==null?false:this.arrRemove(ca,cb)&&(this.count=this.count-1,true);},CopyTo:function(ca,cb){var cc,cd,ce;cc=bM.concat(this.data);for(cd=0,ce=cc.length-1;cd<=ce;cd++)m.set(ca,cd+cb,cc[cd]);},arrRemove:function(ca,cb){var cc,cd,ce,cf;cc=true;cd=0;cf=cb.length;while(cc&&cd<cf)if(this.equals.apply(null,[cb[cd],ca])){cb.splice.apply(cb,[cd,1]);cc=false;}else cd=cd+1;return!cc;}},g,R);R.New$3=b9.Ctor(function(){R.New$4.call(this,[],r.Equals,r.Hash);},R);R.New$4=b9.Ctor(function(ca,cb,cc){var cd;g.New.call(this);this.equals=cb;this.hash=cc;this.data=[];this.count=0;cd=_9.Get(ca);try{while(cd.MoveNext())this.add(cd.Current());}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}},R);R.New$2=b9.Ctor(function(ca){R.New$4.call(this,ca,r.Equals,r.Hash);},R);S.append=function(ca,cb){return{GetEnumerator:function(){var cc,cd;cc=_9.Get(ca);cd=[true];return new _.New(cc,null,function(ce){var cf;return ce.s.MoveNext()?(ce.c=ce.s.Current(),true):(cf=ce.s,!r.Equals(cf,null)?cf.Dispose():void 0,ce.s=null,cd[0]&&(cd[0]=false,ce.s=_9.Get(cb),ce.s.MoveNext()?(ce.c=ce.s.Current(),true):(ce.s.Dispose(),ce.s=null,false)));},function(ce){var cf;cf=ce.s;if(!r.Equals(cf,null))cf.Dispose();});}};};S.head=function(ca){var cb;cb=_9.Get(ca);try{return cb.MoveNext()?cb.Current():S.insufficient();}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}};S.fold=function(ca,cb,cc){var cd,ce;cd=cb;ce=_9.Get(cc);try{while(ce.MoveNext())cd=ca(cd,ce.Current());return cd;}finally{if(typeof ce=="object"&&"Dispose"in ce)ce.Dispose();}};S.iter=function(ca,cb){var cc;cc=_9.Get(cb);try{while(cc.MoveNext())ca(cc.Current());}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};S.map=function(ca,cb){return{GetEnumerator:function(){var cc;cc=_9.Get(cb);return new _.New(null,null,function(cd){return cc.MoveNext()&&(cd.c=ca(cc.Current()),true);},function(){cc.Dispose();});}};};S.delay=function(ca){return{GetEnumerator:function(){return _9.Get(ca());}};};S.max=function(ca){var cb,cc,cd;cb=_9.Get(ca);try{if(!cb.MoveNext())S.seqEmpty();cc=cb.Current();while(cb.MoveNext()){cd=cb.Current();if(r.Compare(cd,cc)===1)cc=cd;}return cc;}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}};S.init=function(ca,cb){return S.take(ca,S.initInfinite(cb));};S.seqEmpty=function(){return f.FailWith("The input sequence was empty.");};S.forall=function(ca,cb){return!S.exists(function(cc){return!ca(cc);},cb);};S.take=function(ca,cb){ca<0?S.nonNegative():void 0;return{GetEnumerator:function(){var cc;cc=[_9.Get(cb)];return new _.New(0,null,function(cd){var ce;cd.s=cd.s+1;return cd.s>ca?false:(ce=cc[0],r.Equals(ce,null)?S.insufficient():ce.MoveNext()?(cd.c=ce.Current(),cd.s===ca?(ce.Dispose(),cc[0]=null):void 0,true):(ce.Dispose(),cc[0]=null,S.insufficient()));},function(){var cd;cd=cc[0];if(!r.Equals(cd,null))cd.Dispose();});}};};S.initInfinite=function(ca){return{GetEnumerator:function(){return new _.New(0,null,function(cb){cb.c=ca(cb.s);cb.s=cb.s+1;return true;},void 0);}};};S.exists=function(ca,cb){var cc,cd;cc=_9.Get(cb);try{cd=false;while(!cd&&cc.MoveNext())cd=ca(cc.Current());return cd;}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};m.choose=function(ca,cb){var cc,cd,ce,cf;cc=[];for(cd=0,ce=cb.length-1;cd<=ce;cd++){cf=ca(cb[cd]);if(cf==null);else cc.push(cf.$0);}return cc;};m.tryFindIndex=function(ca,cb){var cc,cd;cc=null;cd=0;while(cd<cb.length&&cc==null){ca(cb[cd])?cc={$:1,$0:cd}:void 0;cd=cd+1;}return cc;};m.tryPick=function(ca,cb){var cc,cd,ce;cc=null;cd=0;while(cd<cb.length&&cc==null){ce=ca(cb[cd]);if(ce!=null&&ce.$==1)cc=ce;cd=cd+1;}return cc;};m.exists=function(ca,cb){var cc,cd,ce,cf;cc=false;cd=0;cf=m.length(cb);while(!cc&&cd<cf)if(ca(cb[cd]))cc=true;else cd=cd+1;return cc;};m.concat=function(ca){return a.Array.prototype.concat.apply([],m.ofSeq(ca));};m.iter=function(ca,cb){var cc,cd;for(cc=0,cd=cb.length-1;cc<=cd;cc++)ca(cb[cc]);};m.foldBack=function(ca,cb,cc){var cd,ce,cf,cg,ch;cd=cc;cf=cb.length;for(cg=1,ch=cf;cg<=ch;cg++)cd=ca(cb[cf-cg],cd);return cd;};m.map=function(ca,cb){var cc,cd,ce;cc=new a.Array(cb.length);for(cd=0,ce=cb.length-1;cd<=ce;cd++)cc[cd]=ca(cb[cd]);return cc;};m.filter=function(ca,cb){var cc,cd,ce;cc=[];for(cd=0,ce=cb.length-1;cd<=ce;cd++)if(ca(cb[cd]))cc.push(cb[cd]);return cc;};m.ofSeq=function(ca){var cb,cc;if(ca instanceof a.Array)return ca.slice();else if(ca instanceof bC)return m.ofList(ca);else{cb=[];cc=_9.Get(ca);try{while(cc.MoveNext())cb.push(cc.Current());return cb;}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}}};m.pick=function(ca,cb){var cc;cc=m.tryPick(ca,cb);return cc==null?f.FailWith("KeyNotFoundException"):cc.$0;};m.ofList=function(ca){var cb,cc;cc=[];cb=ca;while(!(cb.$==0)){cc.push(bB.head(cb));cb=bB.tail(cb);}return cc;};m.forall=function(ca,cb){var cc,cd,ce,cf;cc=true;cd=0;cf=m.length(cb);while(cc&&cd<cf)if(ca(cb[cd]))cd=cd+1;else cc=false;return cc;};m.create=function(ca,cb){var cc,cd,ce;cc=new a.Array(ca);for(cd=0,ce=ca-1;cd<=ce;cd++)cc[cd]=cb;return cc;};m.init=function(ca,cb){var cc,cd,ce;if(ca<0)f.FailWith("Negative size given.");else null;cc=new a.Array(ca);for(cd=0,ce=ca-1;cd<=ce;cd++)cc[cd]=cb(cd);return cc;};T.$cctor=function(){T.$cctor=a.ignore;T.initialized=new K.New$5();};T=k.TemplateInitializer=b9.Class({},g,T);T.GetOrAddHoleFor=function(ca,cb,cc){var cd,ce,cf,cg;T.$cctor();cd=T.GetHolesFor(ca);ce=(cf=null,[cd.TryGetValue(cb,{get:function(){return cf;},set:function(ch){cf=ch;}}),cf]);return ce[0]?ce[1]:(cg=cc(),(cd.set_Item(cb,cg),cg));};T.GetHolesFor=function(ca){var cb,cc,cd;T.$cctor();cb=(cc=null,[T.initialized.TryGetValue(ca,{get:function(){return cc;},set:function(ce){cc=ce;}}),cc]);return cb[0]?cb[1]:(cd=new K.New$5(),(T.initialized.set_Item(ca,cd),cd));};U=t.VarStr=b9.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:this.fillWith.get_View()};},AddAttribute:function(ca,cb){(ca(cb))(bx.Value(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_0.Map(a.String,this.fillWith.get_View())};}},o,U);U.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},U);V=t.VarFloatUnchecked=b9.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_0.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(ca,cb){(ca(cb))(bx.FloatValueUnchecked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_0.Map(a.String,this.fillWith.get_View())};}},o,V);V.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},V);W=t.VarBool=b9.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_0.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(ca,cb){(ca(cb))(bx.Checked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_0.Map(a.String,this.fillWith.get_View())};}},o,W);W.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},W);X=t.VarDateTime=b9.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_0.Map(function(ca){return(new a.Date(ca)).toLocaleString();},this.fillWith.get_View())};},AddAttribute:function(ca,cb){(ca(cb))(bx.DateTimeValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_0.Map(function(ca){return(new a.Date(ca)).toLocaleString();},this.fillWith.get_View())};}},o,X);X.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},X);Y=t.VarFile=b9.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_0.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(ca,cb){(ca(cb))(bx.FileValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_0.Map(a.String,this.fillWith.get_View())};}},o,Y);Y.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},Y);Z=t.VarDomElement=b9.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},o,Z);Z.New=b9.Ctor(function(ca,cb){o.New.call(this);this.name=ca;this.fillWith=cb;},Z);_0=h.View=b9.Class({},null,_0);_1.TryParseInt32=function(ca,cb){return _1.TryParse(ca,-2147483648,2147483647,cb);};_2=h.ConcreteVar=b9.Class({get_View:function(){return this.view;},Set:function(ca){if(this.isConst)(function(cb){return cb("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cb){b7.log(cb);}));else{_3.Obsolete(this.snap);this.current=ca;this.snap=_3.New({$:2,$0:ca,$1:[]});}},Get:function(){return this.current;},SetFinal:function(ca){if(this.isConst)(function(cb){return cb("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cb){b7.log(cb);}));else{_3.Obsolete(this.snap);this.isConst=true;this.current=ca;this.snap=_3.New({$:0,$0:ca});}},UpdateMaybe:function(ca){var cb;cb=ca(this.Get());if(cb!=null&&cb.$==1)this.Set(cb.$0);}},p,_2);_2.New=b9.Ctor(function(ca,cb,cc){var cd;cd=this;p.New.call(this);this.isConst=ca;this.current=cc;this.snap=cb;this.view=function(){return cd.snap;};this.id=be.Int();},_2);_3.WhenRun=function(ca,cb,cc){var cd;cd=ca.s;if(cd==null)cc();else cd!=null&&cd.$==2?(cd.$1.push(cc),cb(cd.$0)):cd!=null&&cd.$==3?(cd.$0.push(cb),cd.$1.push(cc)):cb(cd.$0);};_3.Map=function(ca,cb){var cc,cd;cc=cb.s;return cc!=null&&cc.$==0?_3.New({$:0,$0:ca(cc.$0)}):(cd=_3.New({$:3,$0:[],$1:[]}),(_3.When(cb,function(ce){_3.MarkDone(cd,cb,ca(ce));},cd),cd));};_3.Map3=function(ca,cb,cc,cd){var ce,cf,cg,ch;function ci(cj){var ck,cl,cm,cn;if(!(ck=ch.s,ck!=null&&ck.$==0||ck!=null&&ck.$==2)){cl=_3.ValueAndForever(cb);cm=_3.ValueAndForever(cc);cn=_3.ValueAndForever(cd);if(cl!=null&&cl.$==1)cm!=null&&cm.$==1?cn!=null&&cn.$==1?cl.$0[1]&&cm.$0[1]&&cn.$0[1]?_3.MarkForever(ch,ca(cl.$0[0],cm.$0[0],cn.$0[0])):_3.MarkReady(ch,ca(cl.$0[0],cm.$0[0],cn.$0[0])):void 0:void 0;}}ce=cb.s;cf=cc.s;cg=cd.s;return ce!=null&&ce.$==0?cf!=null&&cf.$==0?cg!=null&&cg.$==0?_3.New({$:0,$0:ca(ce.$0,cf.$0,cg.$0)}):_3.Map3Opt1(ca,ce.$0,cf.$0,cd):cg!=null&&cg.$==0?_3.Map3Opt2(ca,ce.$0,cg.$0,cc):_3.Map3Opt3(ca,ce.$0,cc,cd):cf!=null&&cf.$==0?cg!=null&&cg.$==0?_3.Map3Opt4(ca,cf.$0,cg.$0,cb):_3.Map3Opt5(ca,cf.$0,cb,cd):cg!=null&&cg.$==0?_3.Map3Opt6(ca,cg.$0,cb,cc):(ch=_3.New({$:3,$0:[],$1:[]}),(_3.When(cb,ci,ch),_3.When(cc,ci,ch),_3.When(cd,ci,ch),ch));};_3.Sequence=function(ca){var cb,cc,cd;function ce(cf){var cg;if(cd[0]===0){cg=m.map(function(ch){var ci;ci=ch.s;return ci!=null&&ci.$==0?ci.$0:ci!=null&&ci.$==2?ci.$0:f.FailWith("value not found by View.Sequence");},cb);if(m.forall(function(ch){var ci;ci=ch.s;return ci!=null&&ci.$==0;},cb))_3.MarkForever(cc,cg);else _3.MarkReady(cc,cg);}else cd[0]=cd[0]-1;}cb=m.ofSeq(ca);return cb.length==0?_3.New({$:0,$0:[]}):(cc=_3.New({$:3,$0:[],$1:[]}),(cd=[m.length(cb)-1],(m.iter(function(cf){_3.When(cf,ce,cc);},cb),cc)));};_3.Map2=function(ca,cb,cc){var cd,ce,cf;function cg(ch){var ci,cj,ck;if(!(ci=cf.s,ci!=null&&ci.$==0||ci!=null&&ci.$==2)){cj=_3.ValueAndForever(cb);ck=_3.ValueAndForever(cc);if(cj!=null&&cj.$==1)ck!=null&&ck.$==1?cj.$0[1]&&ck.$0[1]?_3.MarkForever(cf,ca(cj.$0[0],ck.$0[0])):_3.MarkReady(cf,ca(cj.$0[0],ck.$0[0])):void 0;}}cd=cb.s;ce=cc.s;return cd!=null&&cd.$==0?ce!=null&&ce.$==0?_3.New({$:0,$0:ca(cd.$0,ce.$0)}):_3.Map2Opt1(ca,cd.$0,cc):ce!=null&&ce.$==0?_3.Map2Opt2(ca,ce.$0,cb):(cf=_3.New({$:3,$0:[],$1:[]}),(_3.When(cb,cg,cf),_3.When(cc,cg,cf),cf));};_3.Map2Unit=function(ca,cb){var cc,cd,ce;function cf(){var cg,ch,ci;if(!(cg=ce.s,cg!=null&&cg.$==0||cg!=null&&cg.$==2)){ch=_3.ValueAndForever(ca);ci=_3.ValueAndForever(cb);if(ch!=null&&ch.$==1)ci!=null&&ci.$==1?ch.$0[1]&&ci.$0[1]?_3.MarkForever(ce,null):_3.MarkReady(ce,null):void 0;}}cc=ca.s;cd=cb.s;return cc!=null&&cc.$==0?cd!=null&&cd.$==0?_3.New({$:0,$0:null}):cb:cd!=null&&cd.$==0?ca:(ce=_3.New({$:3,$0:[],$1:[]}),(_3.When(ca,cf,ce),_3.When(cb,cf,ce),ce));};_3.Copy=function(ca){var cb,cc,cd;cb=ca.s;return cb==null?ca:cb!=null&&cb.$==2?(cc=_3.New({$:2,$0:cb.$0,$1:[]}),(_3.WhenObsolete(ca,cc),cc)):cb!=null&&cb.$==3?(cd=_3.New({$:3,$0:[],$1:[]}),(_3.When(ca,function(ce){_3.MarkDone(cd,ca,ce);},cd),cd)):ca;};_3.WhenObsoleteRun=function(ca,cb){var cc;cc=ca.s;if(cc==null)cb();else cc!=null&&cc.$==2?cc.$1.push(cb):cc!=null&&cc.$==3?cc.$1.push(cb):void 0;};_3.When=function(ca,cb,cc){var cd;cd=ca.s;if(cd==null)_3.Obsolete(cc);else cd!=null&&cd.$==2?(_3.EnqueueSafe(cd.$1,cc),cb(cd.$0)):cd!=null&&cd.$==3?(cd.$0.push(cb),_3.EnqueueSafe(cd.$1,cc)):cb(cd.$0);};_3.MarkDone=function(ca,cb,cc){var cd;if(cd=cb.s,cd!=null&&cd.$==0)_3.MarkForever(ca,cc);else _3.MarkReady(ca,cc);};_3.Map3Opt1=function(ca,cb,cc,cd){return _3.Map(function(ce){return ca(cb,cc,ce);},cd);};_3.Map3Opt2=function(ca,cb,cc,cd){return _3.Map(function(ce){return ca(cb,ce,cc);},cd);};_3.Map3Opt3=function(ca,cb,cc,cd){return _3.Map2(function(ce,cf){return ca(cb,ce,cf);},cc,cd);};_3.Map3Opt4=function(ca,cb,cc,cd){return _3.Map(function(ce){return ca(ce,cb,cc);},cd);};_3.Map3Opt5=function(ca,cb,cc,cd){return _3.Map2(function(ce,cf){return ca(ce,cb,cf);},cc,cd);};_3.Map3Opt6=function(ca,cb,cc,cd){return _3.Map2(function(ce,cf){return ca(ce,cf,cb);},cc,cd);};_3.ValueAndForever=function(ca){var cb;cb=ca.s;return cb!=null&&cb.$==0?{$:1,$0:[cb.$0,true]}:cb!=null&&cb.$==2?{$:1,$0:[cb.$0,false]}:null;};_3.MarkForever=function(ca,cb){var cc,cd,ce,cf;cc=ca.s;if(cc!=null&&cc.$==3){ca.s={$:0,$0:cb};cd=cc.$0;for(ce=0,cf=m.length(cd)-1;ce<=cf;ce++)(m.get(cd,ce))(cb);}else void 0;};_3.MarkReady=function(ca,cb){var cc,cd,ce,cf;cc=ca.s;if(cc!=null&&cc.$==3){ca.s={$:2,$0:cb,$1:cc.$1};cd=cc.$0;for(ce=0,cf=m.length(cd)-1;ce<=cf;ce++)(m.get(cd,ce))(cb);}else void 0;};_3.Map2Opt1=function(ca,cb,cc){return _3.Map(function(cd){return ca(cb,cd);},cc);};_3.Map2Opt2=function(ca,cb,cc){return _3.Map(function(cd){return ca(cd,cb);},cc);};_3.WhenObsolete=function(ca,cb){var cc;cc=ca.s;if(cc==null)_3.Obsolete(cb);else cc!=null&&cc.$==2?_3.EnqueueSafe(cc.$1,cb):cc!=null&&cc.$==3?_3.EnqueueSafe(cc.$1,cb):void 0;};_3.EnqueueSafe=function(ca,cb){var cc,cd,ce,cf;ca.push(cb);if(ca.length%20===0){cc=ca.slice(0);b4.Clear(ca);for(cd=0,ce=m.length(cc)-1;cd<=ce;cd++){cf=m.get(cc,cd);if(typeof cf=="object")(function(cg){if(cg.s)ca.push(cg);}(cf));else(function(cg){ca.push(cg);}(cf));}}else void 0;};_4=C.Scheduler=b9.Class({Fork:function(ca){var cb;cb=this;this.robin.push(ca);if(this.idle){this.idle=false;a.setTimeout(function(){cb.tick();},0);}},tick:function(){var ca,cb,cc;cb=this;cc=b$.now();ca=true;while(ca)if(this.robin.length===0){this.idle=true;ca=false;}else{(this.robin.shift())();b$.now()-cc>40?(a.setTimeout(function(){cb.tick();},0),ca=false):void 0;}}},g,_4);_4.New=b9.Ctor(function(){g.New.call(this);this.idle=true;this.robin=[];},_4);_6=A.NonStandardPromiseRejectionException=b9.Class({},_5,_6);_6.New=b9.Ctor(function(ca){this.message="Promise rejected";M.setPrototypeOf(this,_6.prototype);this.reason=ca;},_6);_7.$cctor=function(){_7.$cctor=a.ignore;_7.noneCT=Q.New(false,[]);_7.scheduler=new _4.New();_7.defCTS=[new bg.New()];_7.Zero=C.Return();_7.GetCT=function(ca){ca.k({$:0,$0:ca.ct});};};_8.notPresent=function(){throw new bS.New();};_9.Get=function(ca){return ca instanceof a.Array?_9.ArrayEnumerator(ca):r.Equals(typeof ca,"string")?_9.StringEnumerator(ca):ca.GetEnumerator();};_9.ArrayEnumerator=function(ca){return new _.New(0,null,function(cb){var cc;cc=cb.s;return cc<m.length(ca)&&(cb.c=m.get(ca,cc),cb.s=cc+1,true);},void 0);};_9.StringEnumerator=function(ca){return new _.New(0,null,function(cb){var cc;cc=cb.s;return cc<ca.length&&(cb.c=ca[cc],cb.s=cc+1,true);},void 0);};_9.Get0=function(ca){return ca instanceof a.Array?_9.ArrayEnumerator(ca):r.Equals(typeof ca,"string")?_9.StringEnumerator(ca):"GetEnumerator0"in ca?ca.GetEnumerator0():ca.GetEnumerator();};_=_9.T=b9.Class({MoveNext:function(){var ca;ca=this.n(this);this.e=ca?1:2;return ca;},Current:function(){return this.e===1?this.c:this.e===0?f.FailWith("Enumeration has not started. Call MoveNext."):f.FailWith("Enumeration already finished.");},Dispose:function(){if(this.d)this.d(this);}},g,_);_.New=b9.Ctor(function(ca,cb,cc,cd){g.New.call(this);this.s=ca;this.c=cb;this.n=cc;this.d=cd;this.e=0;},_);$.$cctor=function(){$.$cctor=a.ignore;$.LoadedTemplates=new K.New$5();$.LocalTemplatesLoaded=false;$.GlobalHoles=new K.New$5();$.TextHoleRE="\\${([^}]+)}";$.RenderedFullDocTemplate=null;};ba.LinkElement=function(ca,cb){ba.InsertDoc(ca,cb,null);};ba.InsertDoc=function(ca,cb,cc){var cd,ce,cf;while(true)if(cb!=null&&cb.$==1)return ba.InsertNode(ca,cb.$0.El,cc);else if(cb!=null&&cb.$==2){cd=cb.$0;cd.Dirty=false;cb=cd.Current;}else if(cb==null)return cc;else if(cb!=null&&cb.$==4)return ba.InsertNode(ca,cb.$0.Text,cc);else if(cb!=null&&cb.$==5)return ba.InsertNode(ca,cb.$0,cc);else if(cb!=null&&cb.$==6)return m.foldBack(function(cg,ch){return(((b9.Curried3(function(ci,cj,ck){return cj==null||cj.constructor===M?ba.InsertDoc(ci,cj,ck):ba.InsertNode(ci,cj,ck);}))(ca))(cg))(ch);},cb.$0.Els,cc);else{ce=cb.$1;cf=cb.$0;cb=cf;cc=ba.InsertDoc(ca,ce,cc);}};ba.CreateRunState=function(ca,cb){return bI.New(bJ.get_Empty(),ba.CreateElemNode(ca,bt.EmptyAttr(),cb));};ba.PerformAnimatedUpdate=function(ca,cb,cc){var cd;return bo.get_UseAnimations()?(cd=null,C.Delay(function(){var ce,cf,cg;ce=bJ.FindAll(cc);cf=ba.ComputeChangeAnim(cb,ce);cg=ba.ComputeEnterAnim(cb,ce);return C.Bind(bo.Play(bo.Append(cf,ba.ComputeExitAnim(cb,ce))),function(){return C.Bind(ba.SyncElemNodesNextFrame(ca,cb),function(){return C.Bind(bo.Play(cg),function(){cb.PreviousNodes=ce;return C.Return(null);});});});})):ba.SyncElemNodesNextFrame(ca,cb);};ba.PerformSyncUpdate=function(ca,cb,cc){var cd;cd=bJ.FindAll(cc);ba.SyncElemNode(ca,cb.Top);cb.PreviousNodes=cd;};ba.InsertBeforeDelim=function(ca,cb){var cc,cd;cc=ca.parentNode;cd=self.document.createTextNode("");cc.insertBefore(cd,ca);ba.LinkPrevElement(ca,cb);return cd;};ba.InsertNode=function(ca,cb,cc){bm.InsertAt(ca,cc,cb);return cb;};ba.CreateElemNode=function(ca,cb,cc){var cd;ba.LinkElement(ca,cc);cd=bt.Insert(ca,cb);return bb.New(cd,cc,null,ca,be.Int(),b9.GetOptional(cd.OnAfterRender));};ba.SyncElemNodesNextFrame=function(ca,cb){function cc(cd){a.requestAnimationFrame(function(){ba.SyncElemNode(ca,cb.Top);cd();});}return bp.BatchUpdatesEnabled()?C.FromContinuations(function(cd,ce,cf){return cc.apply(null,[cd,ce,cf]);}):(ba.SyncElemNode(ca,cb.Top),C.Return(null));};ba.ComputeExitAnim=function(ca,cb){return bo.Concat(m.map(function(cc){return bt.GetExitAnim(cc.Attr);},bJ.ToArray(bJ.Except(cb,bJ.Filter(function(cc){return bt.HasExitAnim(cc.Attr);},ca.PreviousNodes)))));};ba.ComputeEnterAnim=function(ca,cb){return bo.Concat(m.map(function(cc){return bt.GetEnterAnim(cc.Attr);},bJ.ToArray(bJ.Except(ca.PreviousNodes,bJ.Filter(function(cc){return bt.HasEnterAnim(cc.Attr);},cb)))));};ba.ComputeChangeAnim=function(ca,cb){var cc;function cd(ce){return bt.HasChangeAnim(ce.Attr);}cc=function(ce){return bJ.Filter(cd,ce);};return bo.Concat(m.map(function(ce){return bt.GetChangeAnim(ce.Attr);},bJ.ToArray(bJ.Intersect(cc(ca.PreviousNodes),cc(cb)))));};ba.SyncElemNode=function(ca,cb){!ca?ba.SyncElement(cb):void 0;ba.Sync(cb.Children);ba.AfterRender(cb);};ba.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};ba.UpdateTextNode=function(ca,cb){ca.Value=cb;ca.Dirty=true;};ba.LinkPrevElement=function(ca,cb){ba.InsertDoc(ca.parentNode,cb,ca);};ba.SyncElement=function(ca){function cb(cc){function cd(ce){var cf,cg,ch,ci;while(true){if(ce!=null&&ce.$==0){cg=ce.$1;ch=ce.$0;if(cd(ch))return true;else ce=cg;}else if(ce!=null&&ce.$==2){ci=ce.$0;if(ci.Dirty)return true;else ce=ci.Current;}else return ce!=null&&ce.$==6&&(cf=ce.$0,cf.Dirty||m.exists(cb,cf.Holes));}}return cd(cc.Children);}bt.Sync(ca.El,ca.Attr);if(cb(ca))ba.DoSyncElement(ca);};ba.Sync=function(ca){var cb,cc,cd,ce,cf;while(true){if(ca!=null&&ca.$==1)return ba.SyncElemNode(false,ca.$0);else if(ca!=null&&ca.$==2){cd=ca.$0;ca=cd.Current;}else if(ca==null)return null;else if(ca!=null&&ca.$==5)return null;else if(ca!=null&&ca.$==4){cb=ca.$0;return cb.Dirty?(cb.Text.nodeValue=cb.Value,cb.Dirty=false):null;}else if(ca!=null&&ca.$==6){cc=ca.$0;m.iter(function(cg){ba.SyncElemNode(false,cg);},cc.Holes);m.iter(function(cg){bt.Sync(cg[0],cg[1]);},cc.Attrs);return ba.AfterRender(cc);}else{ce=ca.$1;cf=ca.$0;ba.Sync(cf);ca=ce;}}};ba.AfterRender=function(ca){var cb;cb=b9.GetOptional(ca.Render);if(cb!=null&&cb.$==1){cb.$0(ca.El);b9.SetOptional(ca,"Render",null);}};ba.DoSyncElement=function(ca){var cb,cc,cd;function ce(cf,cg){var ch,ci,cj,ck;while(true){if(cf!=null&&cf.$==1)return cf.$0.El;else if(cf!=null&&cf.$==2){ci=cf.$0;if(ci.Dirty){ci.Dirty=false;return ba.InsertDoc(cb,ci.Current,cg);}else cf=ci.Current;}else if(cf==null)return cg;else if(cf!=null&&cf.$==4)return cf.$0.Text;else if(cf!=null&&cf.$==5)return cf.$0;else if(cf!=null&&cf.$==6){ch=cf.$0;ch.Dirty?ch.Dirty=false:void 0;return m.foldBack(function(cl,cm){return cl==null||cl.constructor===M?ce(cl,cm):cl;},ch.Els,cg);}else{cj=cf.$1;ck=cf.$0;cf=ck;cg=ce(cj,cg);}}}cb=ca.El;bZ.Iter((cc=ca.El,function(cf){bm.RemoveNode(cc,cf);}),bZ.Except(bZ.DocChildren(ca),bZ.Children(ca.El,b9.GetOptional(ca.Delimiters))));ce(ca.Children,(cd=b9.GetOptional(ca.Delimiters),cd!=null&&cd.$==1?cd.$0[1]:null));};bb=h.DocElemNode=b9.Class({Equals:function(ca){return this.ElKey===ca.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bb);bb.New=function(ca,cb,cc,cd,ce,cf){var cg;return new bb((cg={Attr:ca,Children:cb,El:cd,ElKey:ce},(b9.SetOptional(cg,"Delimiters",cc),b9.SetOptional(cg,"Render",cf),cg)));};be.Int=function(){be.set_counter(be.counter()+1);return be.counter();};be.set_counter=function(ca){bN.$cctor();bN.counter=ca;};be.counter=function(){bN.$cctor();return bN.counter;};bf=b.OperationCanceledException=b9.Class({},_5,bf);bf.New=b9.Ctor(function(ca){bf.New$1.call(this,"The operation was canceled.",null,ca);},bf);bf.New$1=b9.Ctor(function(ca,cb,cc){this.message=ca;this.inner=cb;M.setPrototypeOf(this,bf.prototype);this.ct=cc;},bf);bg=b.CancellationTokenSource=b9.Class({},g,bg);bg.New=b9.Ctor(function(){g.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bg);bi=h.Elt=b9.Class({},I,bi);bi.TreeNode=function(ca,cb){var cc,cd;function ce(cf,cg){return bt.Updates(cg);}cc=bF.Create(cb);return new bi.New$1({$:6,$0:ca},_0.Map2Unit((cd=m.map(function(cf){return ce(cf[0],cf[1]);},ca.Attrs),bE.TreeReduce(_0.Const(),_0.Map2Unit,cd)),cc.v),m.get(ca.Els,0),cc);};bi.New$1=b9.Ctor(function(ca,cb,cc,cd){I.New.call(this,ca,cb);this.docNode$1=ca;this.updates$1=cb;this.elt=cc;this.rvUpdates=cd;},bi);_0.Const=function(ca){var cb;cb=_3.New({$:0,$0:ca});return function(){return cb;};};_0.Sink=function(ca,cb){function cc(){_3.WhenRun(cb(),ca,function(){C.scheduler().Fork(cc);});}C.scheduler().Fork(cc);};_0.Map=function(ca,cb){return _0.CreateLazy(function(){return _3.Map(ca,cb());});};_0.Map3=function(ca,cb,cc,cd){return _0.CreateLazy(function(){return _3.Map3(ca,cb(),cc(),cd());});};_0.Sequence=function(ca){return _0.CreateLazy(function(){return _3.Sequence(S.map(function(cb){return cb();},ca));});};_0.Map2=function(ca,cb,cc){return _0.CreateLazy(function(){return _3.Map2(ca,cb(),cc());});};_0.Map2Unit=function(ca,cb){return _0.CreateLazy(function(){return _3.Map2Unit(ca(),cb());});};_0.CreateLazy=function(ca){var cb;cb={c:null,o:ca};return function(){var cc,cd;cc=cb.c;return cc===null?(cc=cb.o(),cb.c=cc,(cd=cc.s,cd!=null&&cd.$==0)?cb.o=null:_3.WhenObsoleteRun(cc,function(){cb.c=null;}),cc):cc;};};bk.convertTextNode=function(ca){var cb,cc,cd,ce,cf,cg;cb=null;cc=0;ce=ca.textContent;cf=new a.RegExp(H.TextHoleRE(),"g");while(cb=cf.exec(ce),cb!==null){ca.parentNode.insertBefore(self.document.createTextNode(bl.string(ce,{$:1,$0:cc},{$:1,$0:cf.lastIndex-m.get(cb,0).length-1})),ca);cc=cf.lastIndex;cg=self.document.createElement("span");cg.setAttribute("ws-replace",m.get(cb,1).toLowerCase());ca.parentNode.insertBefore(cg,ca);}cf.lastIndex=0;ca.textContent=bl.string(ce,{$:1,$0:cc},null);};bk.failNotLoaded=function(ca){b7.warn("Instantiating non-loaded template",ca);};bk.fillTextHole=function(ca,cb,cc){var cd;cd=ca.querySelector("[ws-replace]");return r.Equals(cd,null)?(b7.warn("Filling non-existent text hole",cc),null):(cd.parentNode.replaceChild(self.document.createTextNode(cb),cd),{$:1,$0:cd.getAttribute("ws-replace")});};bk.removeHolesExcept=function(ca,cb){function cc(cd){H.foreachNotPreserved(ca,"["+cd+"]",function(ce){if(!cb.Contains(ce.getAttribute(cd)))ce.removeAttribute(cd);});}cc("ws-attr");cc("ws-onafterrender");cc("ws-var");H.foreachNotPreserved(ca,"[ws-hole]",function(cd){if(!cb.Contains(cd.getAttribute("ws-hole"))){cd.removeAttribute("ws-hole");while(cd.hasChildNodes())cd.removeChild(cd.lastChild);}});H.foreachNotPreserved(ca,"[ws-replace]",function(cd){if(!cb.Contains(cd.getAttribute("ws-replace")))cd.parentNode.removeChild(cd);});H.foreachNotPreserved(ca,"[ws-on]",function(cd){cd.setAttribute("ws-on",bD.concat(" ",m.filter(function(ce){return cb.Contains(m.get(bD.SplitChars(ce,[":"],1),1));},bD.SplitChars(cd.getAttribute("ws-on"),[" "],1))));});H.foreachNotPreserved(ca,"[ws-attr-holes]",function(cd){var ce,cf,cg,ch,ci;ce=bD.SplitChars(cd.getAttribute("ws-attr-holes"),[" "],1);for(cf=0,cg=ce.length-1;cf<=cg;cf++){ch=m.get(ce,cf);cd.setAttribute(ch,(ci=new a.RegExp(H.TextHoleRE(),"g"),cd.getAttribute(ch).replace(ci,function(cj,ck){return cb.Contains(ck)?cj:"";})));}});};bk.fillInstanceAttrs=function(ca,cb){var cc,cd,ce,cf,cg;bk.convertAttrs(cb);cc=cb.nodeName.toLowerCase();cd=ca.querySelector("[ws-attr="+cc+"]");if(r.Equals(cd,null))b7.warn("Filling non-existent attr hole",cc);else{cd.removeAttribute("ws-attr");for(ce=0,cf=cb.attributes.length-1;ce<=cf;ce++){cg=cb.attributes.item(ce);if(cg.name=="class"&&cd.hasAttribute("class"))cd.setAttribute("class",cd.getAttribute("class")+" "+cg.nodeValue);else cd.setAttribute(cg.name,cg.nodeValue);}}};bk.mapHoles=function(ca,cb){function cc(cd){H.foreachNotPreserved(ca,"["+cd+"]",function(ce){var cf,cg;cf=(cg=null,[cb.TryGetValue(ce.getAttribute(cd).toLowerCase(),{get:function(){return cg;},set:function(ch){cg=ch;}}),cg]);if(cf[0])ce.setAttribute(cd,cf[1]);});}cc("ws-hole");cc("ws-replace");cc("ws-attr");cc("ws-onafterrender");cc("ws-var");H.foreachNotPreserved(ca,"[ws-on]",function(cd){cd.setAttribute("ws-on",bD.concat(" ",m.map(function(ce){var cf,cg,ch;cf=bD.SplitChars(ce,[":"],1);cg=(ch=null,[cb.TryGetValue(m.get(cf,1),{get:function(){return ch;},set:function(ci){ch=ci;}}),ch]);return cg[0]?m.get(cf,0)+":"+cg[1]:ce;},bD.SplitChars(cd.getAttribute("ws-on"),[" "],1))));});H.foreachNotPreserved(ca,"[ws-attr-holes]",function(cd){var ce,cf,cg;ce=bD.SplitChars(cd.getAttribute("ws-attr-holes"),[" "],1);for(cf=0,cg=ce.length-1;cf<=cg;cf++)(function(){var ch;function ci(cj,ck){var cl;cl=f.KeyValue(ck);return cj.replace(new a.RegExp("\\${"+cl[0]+"}","ig"),"${"+cl[1]+"}");}ch=m.get(ce,cf);return cd.setAttribute(ch,(((b9.Curried3(S.fold))(ci))(cd.getAttribute(ch)))(cb));}());});};bk.fill=function(ca,cb,cc){while(true)if(ca.hasChildNodes())cc=cb.insertBefore(ca.lastChild,cc);else return null;};bk.convertAttrs=function(ca){var cc,cd,ce,cf,cg,ch,ci,cj;function cb(ck){var cl;cl=ca.getAttribute(ck);if(cl==null);else ca.setAttribute(ck,cl.toLowerCase());}cc=ca.attributes;cd=[];ce=[];cf=[];for(cg=0,ch=cc.length-1;cg<=ch;cg++){ci=cc.item(cg);if(bD.StartsWith(ci.nodeName,"ws-on")&&ci.nodeName!="ws-onafterrender"&&ci.nodeName!="ws-on"){cd.push(ci.nodeName);ce.push(bl.string(ci.nodeName,{$:1,$0:"ws-on".length},null)+":"+ci.nodeValue.toLowerCase());}else!bD.StartsWith(ci.nodeName,"ws-")&&(new a.RegExp(H.TextHoleRE())).test(ci.nodeValue)?(ci.nodeValue=(cj=new a.RegExp(H.TextHoleRE(),"g"),ci.nodeValue.replace(cj,function(ck,cl){return"${"+cl.toLowerCase()+"}";})),cf.push(ci.nodeName)):void 0;}if(!(ce.length==0))ca.setAttribute("ws-on",bD.concat(" ",ce));if(!(cf.length==0))ca.setAttribute("ws-attr-holes",bD.concat(" ",cf));cb("ws-hole");cb("ws-replace");cb("ws-attr");cb("ws-onafterrender");cb("ws-var");m.iter(function(ck){ca.removeAttribute(ck);},cd);};bl.string=function(ca,cb,cc){var cd,ce;return cb==null?cc!=null&&cc.$==1?(cd=cc.$0,cd<0?"":ca.slice(0,cd+1)):"":cc==null?ca.slice(cb.$0):(ce=cc.$0,ce<0?"":ca.slice(cb.$0,ce+1));};bm.ParseHTMLIntoFakeRoot=function(ca){var cb,cc,cd,ce,cf;function cg(ch,ci){var cj;while(true)if(ci===0)return ch;else{cj=ci;ch=ch.lastChild;ci=cj-1;}}cb=self.document.createElement("div");return!bm.rhtml().test(ca)?(cb.appendChild(self.document.createTextNode(ca)),cb):(cc=(cd=bm.rtagName().exec(ca),r.Equals(cd,null)?"":m.get(cd,1).toLowerCase()),(ce=(cf=(bm.wrapMap())[cc],cf?cf:bm.defaultWrap()),(cb.innerHTML=ce[1]+ca.replace(bm.rxhtmlTag(),"<$1></$2>")+ce[2],cg(cb,ce[0]))));};bm.ChildrenArray=function(ca){var cb,cc,cd;cb=[];for(cc=0,cd=ca.childNodes.length-1;cc<=cd;cc++)cb.push(ca.childNodes[cc]);return cb;};bm.rhtml=function(){bO.$cctor();return bO.rhtml;};bm.wrapMap=function(){bO.$cctor();return bO.wrapMap;};bm.defaultWrap=function(){bO.$cctor();return bO.defaultWrap;};bm.rxhtmlTag=function(){bO.$cctor();return bO.rxhtmlTag;};bm.rtagName=function(){bO.$cctor();return bO.rtagName;};bm.IterSelector=function(ca,cb,cc){var cd,ce,cf;cd=ca.querySelectorAll(cb);for(ce=0,cf=cd.length-1;ce<=cf;ce++)cc(cd[ce]);};bm.IterSelectorDoc=function(ca,cb){var cc,cd,ce;cc=self.document.querySelectorAll(ca);for(cd=0,ce=cc.length-1;cd<=ce;cd++)cb(cc[cd]);};bm.InsertAt=function(ca,cb,cc){var cd;if(!(cc.parentNode===ca&&cb===(cd=cc.nextSibling,r.Equals(cd,null)?null:cd)))ca.insertBefore(cc,cb);};bm.RemoveNode=function(ca,cb){if(cb.parentNode===ca)ca.removeChild(cb);};S.insufficient=function(){return f.FailWith("The input sequence has an insufficient number of elements.");};S.nonNegative=function(){return f.FailWith("The input must be non-negative.");};bn=J.KeyCollection=b9.Class({GetEnumerator:function(){return _9.Get(S.map(function(ca){return ca.K;},this.d));}},g,bn);bn.New=b9.Ctor(function(ca){g.New.call(this);this.d=ca;},bn);bo.get_UseAnimations=function(){return bK.UseAnimations();};bo.Play=function(ca){var cb;cb=null;return C.Delay(function(){return C.Bind(bo.Run(a.ignore,bK.Actions(ca)),function(){bK.Finalize(ca);return C.Return(null);});});};bo.Append=function(ca,cb){return{$:0,$0:bQ.Append(ca.$0,cb.$0)};};bo.Run=function(ca,cb){var cc;function cd(ce){function cf(cg){return function(ch){var ci;ci=ch-cg;cb.Compute(ci);ca();return ci<=cc?void a.requestAnimationFrame(function(cj){(cf(cg))(cj);}):ce();};}a.requestAnimationFrame(function(cg){(cf(cg))(cg);});}cc=cb.Duration;return cc===0?C.Zero():C.FromContinuations(function(ce,cf,cg){return cd.apply(null,[ce,cf,cg]);});};bo.Concat=function(ca){return{$:0,$0:bQ.Concat(S.map(bK.List,ca))};};bo.get_Empty=function(){return{$:0,$0:bQ.Empty()};};bp.BatchUpdatesEnabled=function(){bL.$cctor();return bL.BatchUpdatesEnabled;};bq.StartProcessor=function(ca){var cb;function cc(){var cd;cd=null;return C.Delay(function(){return C.Bind(ca,function(){var ce;ce=cb[0];return r.Equals(ce,1)?(cb[0]=0,C.Zero()):r.Equals(ce,2)?(cb[0]=1,cc()):C.Zero();});});}cb=[0];return function(){var cd;cd=cb[0];if(r.Equals(cd,0)){cb[0]=1;C.Start(cc(),null);}else r.Equals(cd,1)?cb[0]=2:void 0;};};bs.New=function(ca,cb,cc,cd){var ce;ce={DynElem:ca,DynFlags:cb,DynNodes:cc};b9.SetOptional(ce,"OnAfterRender",cd);return ce;};_3.Obsolete=function(ca){var cb,cc,cd,ce,cf;cc=ca.s;if(cc==null||(cc!=null&&cc.$==2?(cb=cc.$1,false):cc!=null&&cc.$==3?(cb=cc.$1,false):true))void 0;else{ca.s=null;for(cd=0,ce=m.length(cb)-1;cd<=ce;cd++){cf=m.get(cb,cd);if(typeof cf=="object")(function(cg){_3.Obsolete(cg);}(cf));else cf();}}};_3.New=function(ca){return{s:ca};};bt.Insert=function(ca,cb){var cc,cd,ce;function cf(cg){var ch,ci;while(true)if(!(cg===null)){if(cg!=null&&cg.$==1)return cc.push(cg.$0);else if(cg!=null&&cg.$==2){ch=cg.$1;ci=cg.$0;cf(ci);cg=ch;}else return cg!=null&&cg.$==3?cg.$0(ca):cg!=null&&cg.$==4?cd.push(cg.$0):null;}else return null;}cc=[];cd=[];cf(cb);ce=cc.slice(0);return bs.New(ca,bt.Flags(cb),ce,cd.length===0?null:{$:1,$0:function(cg){S.iter(function(ch){ch(cg);},cd);}});};bt.Updates=function(ca){return bE.MapTreeReduce(function(cb){return cb.NChanged();},_0.Const(),_0.Map2Unit,ca.DynNodes);};bt.Empty=function(ca){return bs.New(ca,0,[],null);};bt.Flags=function(ca){return ca!==null&&ca.hasOwnProperty("flags")?ca.flags:0;};bt.Static=function(ca){return new by({$:3,$0:ca});};bt.Dynamic=function(ca,cb){return new by({$:1,$0:new bR.New(ca,cb)});};bt.EmptyAttr=function(){bT.$cctor();return bT.EmptyAttr;};bt.HasExitAnim=function(ca){var cb;cb=2;return(ca.DynFlags&cb)===cb;};bt.GetExitAnim=function(ca){return bt.GetAnim(ca,function(cb,cc){return cb.NGetExitAnim(cc);});};bt.HasEnterAnim=function(ca){var cb;cb=1;return(ca.DynFlags&cb)===cb;};bt.GetEnterAnim=function(ca){return bt.GetAnim(ca,function(cb,cc){return cb.NGetEnterAnim(cc);});};bt.HasChangeAnim=function(ca){var cb;cb=4;return(ca.DynFlags&cb)===cb;};bt.GetChangeAnim=function(ca){return bt.GetAnim(ca,function(cb,cc){return cb.NGetChangeAnim(cc);});};bt.AppendTree=function(ca,cb){var cc;return ca===null?cb:cb===null?ca:(cc=new by({$:2,$0:ca,$1:cb}),(bt.SetFlags(cc,bt.Flags(ca)|bt.Flags(cb)),cc));};bt.GetAnim=function(ca,cb){return bo.Concat(m.map(function(cc){return cb(cc,ca.DynElem);},ca.DynNodes));};bt.Sync=function(ca,cb){m.iter(function(cc){cc.NSync(ca);},cb.DynNodes);};bt.SetFlags=function(ca,cb){ca.flags=cb;};bu=t.Elt=b9.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bu);bv=t.Attribute=b9.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bv);bw=t.Event=b9.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bw);bx.Handler=function(ca,cb){return bt.Static(function(cc){cc.addEventListener(ca,function(cd){return(cb(cc))(cd);},false);});};bx.OnAfterRender=function(ca){return new by({$:4,$0:ca});};bx.Dynamic=function(ca,cb){return bt.Dynamic(cb,function(cc){return function(cd){return cc.setAttribute(ca,cd);};});};bx.Value=function(ca){return bx.ValueWith(bW.StringApply(),ca);};bx.FloatValueUnchecked=function(ca){return bx.ValueWith(bW.FloatApplyUnchecked(),ca);};bx.Checked=function(ca){return bx.ValueWith(bW.BoolCheckedApply(),ca);};bx.DateTimeValue=function(ca){return bx.ValueWith(bW.DateTimeApplyUnchecked(),ca);};bx.FileValue=function(ca){return bx.ValueWith(bW.FileApplyUnchecked(),ca);};bx.ValueWith=function(ca,cb){var cc;cc=ca(cb);return by.Append(bt.Static(cc[0]),bx.DynamicCustom(cc[1],cc[2]));};bx.DynamicCustom=function(ca,cb){return bt.Dynamic(cb,ca);};by=h.AttrProxy=b9.Class({},null,by);by.Handler=function(ca,cb){return by.HandlerImpl(ca,cb);};by.Concat=function(ca){var cb;cb=bE.ofSeqNonCopying(ca);return bE.TreeReduce(bt.EmptyAttr(),by.Append,cb);};by.Create=function(ca,cb){return bt.Static(function(cc){cc.setAttribute(ca,cb);});};by.HandlerImpl=function(ca,cb){return bt.Static(function(cc){cc.addEventListener(ca,function(cd){return(cb(cc))(cd);},false);});};by.Append=function(ca,cb){return bt.AppendTree(ca,cb);};bz=t.AfterRender=b9.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bz);bA=t.AfterRenderQ=b9.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bA);bC=bB.T=b9.Class({GetEnumerator:function(){return new _.New(this,null,function(ca){var cb;cb=ca.s;return cb.$==0?false:(ca.c=cb.$0,ca.s=cb.$1,true);},void 0);}},null,bC);bC.Empty=new bC({$:0});bD.concat=function(ca,cb){return m.ofSeq(cb).join(ca);};bD.SplitChars=function(ca,cb,cc){return bD.Split(ca,new a.RegExp("["+bD.RegexEscape(cb.join(""))+"]"),cc);};bD.StartsWith=function(ca,cb){return ca.substring(0,cb.length)==cb;};bD.Split=function(ca,cb,cc){return cc===1?m.filter(function(cd){return cd!=="";},bD.SplitWith(ca,cb)):bD.SplitWith(ca,cb);};bD.RegexEscape=function(ca){return ca.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bD.SplitWith=function(ca,cb){return ca.split(cb);};bD.forall=function(ca,cb){return S.forall(ca,bD.protect(cb));};bD.protect=function(ca){return ca==null?"":ca;};bE.TreeReduce=function(ca,cb,cc){var cd;function ce(cf){return function(cg){var ch,ci;switch(cg<=0?0:cg===1?cf>=0&&cf<cd?1:(ch=cg,2):(ch=cg,2)){case 0:return ca;case 1:return m.get(cc,cf);case 2:ci=cg/2>>0;return cb((ce(cf))(ci),(ce(cf+ci))(cg-ci));}};}cd=m.length(cc);return(ce(0))(cd);};bE.MapTreeReduce=function(ca,cb,cc,cd){var ce;function cf(cg){return function(ch){var ci,cj;switch(ch<=0?0:ch===1?cg>=0&&cg<ce?1:(ci=ch,2):(ci=ch,2)){case 0:return cb;case 1:return ca(m.get(cd,cg));case 2:cj=ch/2>>0;return cc((cf(cg))(cj),(cf(cg+cj))(ch-cj));}};}ce=m.length(cd);return(cf(0))(ce);};bE.ofSeqNonCopying=function(ca){var cb,cc;if(ca instanceof a.Array)return ca;else if(ca instanceof bC)return m.ofList(ca);else if(ca===null)return[];else{cb=[];cc=_9.Get(ca);try{while(cc.MoveNext())cb.push(cc.Current());return cb;}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}}};bF=h.Updates=b9.Class({},null,bF);bF.Create=function(ca){var cb;cb=null;cb=bF.New(ca,null,function(){var cc;cc=cb.s;return cc===null?(cc=_3.Copy(cb.c()),cb.s=cc,_3.WhenObsoleteRun(cc,function(){cb.s=null;}),cc):cc;});return cb;};bF.New=function(ca,cb,cc){return new bF({c:ca,s:cb,v:cc});};bG=J.ValueCollection=b9.Class({GetEnumerator:function(){return _9.Get(S.map(function(ca){return ca.V;},this.d));}},g,bG);bG.New=b9.Ctor(function(ca){g.New.call(this);this.d=ca;},bG);bI.New=function(ca,cb){return{PreviousNodes:ca,Top:cb};};bJ.get_Empty=function(){return{$:0,$0:new R.New$3()};};bJ.FindAll=function(ca){var cb;function cc(cf,cg){var ch,ci,cj,ck,cl;while(true)switch(cf){case 0:if(cg!=null&&cg.$==0){ci=cg.$1;cj=cg.$0;cc(0,cj);cg=ci;}else if(cg!=null&&cg.$==1){ck=cg.$0;cg=ck;cf=1;}else if(cg!=null&&cg.$==2){cl=cg.$0;cg=cl.Current;}else return cg!=null&&cg.$==6?(ch=cg.$0.Holes,(function(cm){return function(cn){m.iter(cm,cn);};}(ce))(ch)):null;break;case 1:cb.push(cg);cg=cg.Children;cf=0;break;}}function cd(cf){return cc(0,cf);}function ce(cf){return cc(1,cf);}cb=[];cd(ca);return{$:0,$0:new R.New$2(cb)};};bJ.Filter=function(ca,cb){return{$:0,$0:bV.Filter(ca,cb.$0)};};bJ.Except=function(ca,cb){return{$:0,$0:bV.Except(ca.$0,cb.$0)};};bJ.ToArray=function(ca){return bV.ToArray(ca.$0);};bJ.Intersect=function(ca,cb){return{$:0,$0:bV.Intersect(ca.$0,cb.$0)};};bK.UseAnimations=function(){bP.$cctor();return bP.UseAnimations;};bK.Actions=function(ca){return bK.ConcatActions(m.choose(function(cb){return cb.$==1?{$:1,$0:cb.$0}:null;},bQ.ToArray(ca.$0)));};bK.Finalize=function(ca){m.iter(function(cb){if(cb.$==0)cb.$0();},bQ.ToArray(ca.$0));};bK.ConcatActions=function(ca){var cb,cc,cd,ce;cb=bE.ofSeqNonCopying(ca);cc=m.length(cb);return cc===0?bK.Const():cc===1?m.get(cb,0):(cd=S.max(S.map(function(cf){return cf.Duration;},cb)),(ce=m.map(function(cf){return bK.Prolong(cd,cf);},cb),bK.Def(cd,function(cf){m.iter(function(cg){cg.Compute(cf);},ce);})));};bK.List=function(ca){return ca.$0;};bK.Const=function(ca){return bK.Def(0,function(){return ca;});};bK.Def=function(ca,cb){return{Compute:cb,Duration:ca};};bK.Prolong=function(ca,cb){var cc,cd,ce;cc=cb.Compute;cd=cb.Duration;ce=b2.Create(function(){return cb.Compute(cb.Duration);});return{Compute:function(cf){return cf>=cd?ce.f():cc(cf);},Duration:ca};};bL.$cctor=function(){bL.$cctor=a.ignore;bL.BatchUpdatesEnabled=true;};bM.concat=function(ca){var cb,cc;cb=[];for(var cd in ca)cb.push.apply(cb,ca[cd]);return cb;};bN.$cctor=function(){bN.$cctor=a.ignore;bN.counter=0;};bO.$cctor=function(){var ca;bO.$cctor=a.ignore;bO.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bO.rtagName=new a.RegExp("<([\\w:]+)");bO.rhtml=new a.RegExp("<|&#?\\w+;");bO.wrapMap=(ca=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:ca,tbody:ca,tfoot:ca,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bO.defaultWrap=[0,"",""];};bP.$cctor=function(){bP.$cctor=a.ignore;bP.CubicInOut=bU.Custom(function(ca){var cb;cb=ca*ca;return 3*cb-2*(cb*ca);});bP.UseAnimations=true;};bQ.Append=function(ca,cb){return ca.$==0?cb:cb.$==0?ca:{$:2,$0:ca,$1:cb};};bQ.ToArray=function(ca){var cb;function cc(cd){var ce,cf;while(true)if(cd.$==1)return cb.push(cd.$0);else if(cd.$==2){ce=cd.$1;cf=cd.$0;cc(cf);cd=ce;}else return cd.$==3?m.iter(function(cg){cb.push(cg);},cd.$0):null;}cb=[];cc(ca);return cb.slice(0);};bQ.Concat=function(ca){var cb;cb=bE.ofSeqNonCopying(ca);return bE.TreeReduce(bQ.Empty(),bQ.Append,cb);};bQ.Empty=function(){b3.$cctor();return b3.Empty;};bR=h.DynamicAttrNode=b9.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(ca){return bo.get_Empty();},NGetEnterAnim:function(ca){return bo.get_Empty();},NGetChangeAnim:function(ca){return bo.get_Empty();},NSync:function(ca){if(this.dirty){(this.push(ca))(this.value);this.dirty=false;}}},g,bR);bR.New=b9.Ctor(function(ca,cb){var cc;cc=this;g.New.call(this);this.push=cb;this.value=void 0;this.dirty=false;this.updates=_0.Map(function(cd){cc.value=cd;cc.dirty=true;},ca);},bR);bS=b.KeyNotFoundException=b9.Class({},_5,bS);bS.New=b9.Ctor(function(){bS.New$1.call(this,"The given key was not present in the dictionary.");},bS);bS.New$1=b9.Ctor(function(ca){this.message=ca;M.setPrototypeOf(this,bS.prototype);},bS);bT.$cctor=function(){var ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn;bT.$cctor=a.ignore;bT.EmptyAttr=null;bT.BoolCheckedApply=function(co){function cp(cq,cr){return cr!=null&&cr.$==1?void(cq.checked=cr.$0):null;}return[function(cq){cq.addEventListener("change",function(){return co.Get()!=cq.checked?co.Set(cq.checked):null;});},function(cq){return function(cr){return cp(cq,cr);};},_0.Map(function(cq){return{$:1,$0:cq};},co.get_View())];};bT.StringSet=function(co){return function(cp){co.value=cp;};};bT.StringGet=function(co){return{$:1,$0:co.value};};bT.StringApply=(ca=bW.StringGet(),(cb=bW.StringSet(),function(co){return bW.ApplyValue(ca,cb,co);}));bT.DateTimeSetUnchecked=function(co){return function(cp){co.value=(new b$(cp)).toLocaleString();};};bT.DateTimeGetUnchecked=function(co){var cp,cq,cr,cs;cp=co.value;return bX.isBlank(cp)?{$:1,$0:-8640000000000000}:(cq=(cr=0,[(cs=b1.TryParse(cp),cs!=null&&cs.$==1&&(cr=cs.$0,true)),cr]),cq[0]?{$:1,$0:cq[1]}:null);};bT.DateTimeApplyUnchecked=(cc=bW.DateTimeGetUnchecked(),(cd=bW.DateTimeSetUnchecked(),function(co){return bW.ApplyValue(cc,cd,co);}));bT.FileSetUnchecked=function(){return function(){return null;};};bT.FileGetUnchecked=function(co){var cp;cp=co.files;return{$:1,$0:m.ofSeq(S.delay(function(){return S.map(function(cq){return cp.item(cq);},f.range(0,cp.length-1));}))};};bT.FileApplyUnchecked=(ce=bW.FileGetUnchecked(),(cf=bW.FileSetUnchecked(),function(co){return bW.FileApplyValue(ce,cf,co);}));bT.IntSetUnchecked=function(co){return function(cp){co.value=a.String(cp);};};bT.IntGetUnchecked=function(co){var cp,cq;cp=co.value;return bX.isBlank(cp)?{$:1,$0:0}:(cq=+cp,cq!==cq>>0?null:{$:1,$0:cq});};bT.IntApplyUnchecked=(cg=bW.IntGetUnchecked(),(ch=bW.IntSetUnchecked(),function(co){return bW.ApplyValue(cg,ch,co);}));bT.IntSetChecked=function(co){return function(cp){var cq;cq=cp.get_Input();return co.value!=cq?void(co.value=cq):null;};};bT.IntGetChecked=function(co){var cp,cq,cr;cp=co.value;return{$:1,$0:bX.isBlank(cp)?(co.checkValidity?co.checkValidity():true)?new bY({$:2,$0:cp}):new bY({$:1,$0:cp}):(cq=(cr=0,[_1.TryParseInt32(cp,{get:function(){return cr;},set:function(cs){cr=cs;}}),cr]),cq[0]?new bY({$:0,$0:cq[1],$1:cp}):new bY({$:1,$0:cp}))};};bT.IntApplyChecked=(ci=bW.IntGetChecked(),(cj=bW.IntSetChecked(),function(co){return bW.ApplyValue(ci,cj,co);}));bT.FloatSetUnchecked=function(co){return function(cp){co.value=a.String(cp);};};bT.FloatGetUnchecked=function(co){var cp,cq;cp=co.value;return bX.isBlank(cp)?{$:1,$0:0}:(cq=+cp,a.isNaN(cq)?null:{$:1,$0:cq});};bT.FloatApplyUnchecked=(ck=bW.FloatGetUnchecked(),(cl=bW.FloatSetUnchecked(),function(co){return bW.ApplyValue(ck,cl,co);}));bT.FloatSetChecked=function(co){return function(cp){var cq;cq=cp.get_Input();return co.value!=cq?void(co.value=cq):null;};};bT.FloatGetChecked=function(co){var cp,cq;cp=co.value;return{$:1,$0:bX.isBlank(cp)?(co.checkValidity?co.checkValidity():true)?new bY({$:2,$0:cp}):new bY({$:1,$0:cp}):(cq=+cp,a.isNaN(cq)?new bY({$:1,$0:cp}):new bY({$:0,$0:cq,$1:cp}))};};bT.FloatApplyChecked=(cm=bW.FloatGetChecked(),(cn=bW.FloatSetChecked(),function(co){return bW.ApplyValue(cm,cn,co);}));};bU=h.Easing=b9.Class({},g,bU);bU.Custom=function(ca){return new bU.New(ca);};bU.New=b9.Ctor(function(ca){g.New.call(this);this.transformTime=ca;},bU);bV.Filter=function(ca,cb){return new R.New$2(m.filter(ca,bV.ToArray(cb)));};bV.Except=function(ca,cb){var cc;cc=new R.New$2(bV.ToArray(cb));cc.ExceptWith(bV.ToArray(ca));return cc;};bV.ToArray=function(ca){var cb;cb=m.create(ca.Count(),void 0);ca.CopyTo(cb,0);return cb;};bV.Intersect=function(ca,cb){var cc;cc=new R.New$2(bV.ToArray(ca));cc.IntersectWith(bV.ToArray(cb));return cc;};bB.head=function(ca){return ca.$==1?ca.$0:bB.listEmpty();};bB.tail=function(ca){return ca.$==1?ca.$1:bB.listEmpty();};bB.listEmpty=function(){return f.FailWith("The input list was empty.");};bW.ApplyValue=function(ca,cb,cc){var cd;function ce(cf,cg){return cg==null?null:cf(cg.$0);}cd=null;return[function(cf){function cg(){cc.UpdateMaybe(function(ch){var ci;cd=ca(cf);return cd!=null&&cd.$==1&&(!r.Equals(cd.$0,ch)&&(ci=[cd,cd.$0],true))?ci[0]:null;});}cf.addEventListener("change",cg);cf.addEventListener("input",cg);cf.addEventListener("keypress",cg);},function(cf){var cg;cg=cb(cf);return function(ch){return ce(cg,ch);};},_0.Map(function(cf){var cg;return cd!=null&&cd.$==1&&(r.Equals(cd.$0,cf)&&(cg=cd.$0,true))?null:{$:1,$0:cf};},cc.get_View())];};bW.StringSet=function(){bT.$cctor();return bT.StringSet;};bW.StringGet=function(){bT.$cctor();return bT.StringGet;};bW.DateTimeSetUnchecked=function(){bT.$cctor();return bT.DateTimeSetUnchecked;};bW.DateTimeGetUnchecked=function(){bT.$cctor();return bT.DateTimeGetUnchecked;};bW.FileApplyValue=function(ca,cb,cc){var cd;function ce(cf,cg){return cg==null?null:cf(cg.$0);}cd=null;return[function(cf){cf.addEventListener("change",function(){cc.UpdateMaybe(function(cg){var ch;cd=ca(cf);return cd!=null&&cd.$==1&&(cd.$0!==cg&&(ch=[cd,cd.$0],true))?ch[0]:null;});});},function(cf){var cg;cg=cb(cf);return function(ch){return ce(cg,ch);};},_0.Map(function(cf){var cg;return cd!=null&&cd.$==1&&(r.Equals(cd.$0,cf)&&(cg=cd.$0,true))?null:{$:1,$0:cf};},cc.get_View())];};bW.FileSetUnchecked=function(){bT.$cctor();return bT.FileSetUnchecked;};bW.FileGetUnchecked=function(){bT.$cctor();return bT.FileGetUnchecked;};bW.IntSetUnchecked=function(){bT.$cctor();return bT.IntSetUnchecked;};bW.IntGetUnchecked=function(){bT.$cctor();return bT.IntGetUnchecked;};bW.IntSetChecked=function(){bT.$cctor();return bT.IntSetChecked;};bW.IntGetChecked=function(){bT.$cctor();return bT.IntGetChecked;};bW.FloatSetUnchecked=function(){bT.$cctor();return bT.FloatSetUnchecked;};bW.FloatGetUnchecked=function(){bT.$cctor();return bT.FloatGetUnchecked;};bW.FloatSetChecked=function(){bT.$cctor();return bT.FloatSetChecked;};bW.FloatGetChecked=function(){bT.$cctor();return bT.FloatGetChecked;};bW.StringApply=function(){bT.$cctor();return bT.StringApply;};bW.FloatApplyUnchecked=function(){bT.$cctor();return bT.FloatApplyUnchecked;};bW.BoolCheckedApply=function(){bT.$cctor();return bT.BoolCheckedApply;};bW.DateTimeApplyUnchecked=function(){bT.$cctor();return bT.DateTimeApplyUnchecked;};bW.FileApplyUnchecked=function(){bT.$cctor();return bT.FileApplyUnchecked;};bX.isBlank=function(ca){return bD.forall(b0.IsWhiteSpace,ca);};bY=h.CheckedInput=b9.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bY);bZ.Children=function(ca,cb){var cc,cd,ce;if(cb!=null&&cb.$==1){ce=[];cc=cb.$0[0].nextSibling;while(cc!==cb.$0[1]){ce.push(cc);cc=cc.nextSibling;}return{$:0,$0:ce};}else return{$:0,$0:m.init(ca.childNodes.length,(cd=ca.childNodes,function(cf){return cd[cf];}))};};bZ.Except=function(ca,cb){var cc;cc=ca.$0;return{$:0,$0:m.filter(function(cd){return m.forall(function(ce){return!(cd===ce);},cc);},cb.$0)};};bZ.Iter=function(ca,cb){m.iter(ca,cb.$0);};bZ.DocChildren=function(ca){var cb;function cc(cd){var ce,cf,cg,ch;while(true){if(cd!=null&&cd.$==2){cf=cd.$0;cd=cf.Current;}else if(cd!=null&&cd.$==1)return cb.push(cd.$0.El);else if(cd==null)return null;else if(cd!=null&&cd.$==5)return cb.push(cd.$0);else if(cd!=null&&cd.$==4)return cb.push(cd.$0.Text);else if(cd!=null&&cd.$==6){ce=cd.$0.Els;return(function(ci){return function(cj){m.iter(ci,cj);};}(function(ci){if(ci==null||ci.constructor===M)cc(ci);else cb.push(ci);}))(ce);}else{cg=cd.$1;ch=cd.$0;cc(ch);cd=cg;}}}cb=[];cc(ca.Children);return{$:0,$0:bE.ofSeqNonCopying(cb)};};b0.IsWhiteSpace=function(ca){return ca.match(new a.RegExp("\\s"))!==null;};b1.TryParse=function(ca){var cb;cb=b$.parse(ca);return a.isNaN(cb)?null:{$:1,$0:cb};};_1.TryParse=function(ca,cb,cc,cd){var ce,cf;ce=+ca;cf=ce===ce-ce%1&&ce>=cb&&ce<=cc;if(cf)cd.set(ce);return cf;};b2.Create=function(ca){return b6.New(false,ca,b2.forceLazy);};b2.forceLazy=function(){var ca;ca=this.v();this.c=true;this.v=ca;this.f=b2.cachedLazy;return ca;};b2.cachedLazy=function(){return this.v;};b3.$cctor=function(){b3.$cctor=a.ignore;b3.Empty={$:0};};b4.Clear=function(ca){ca.splice(0,m.length(ca));};b6.New=function(ca,cb,cc){return{c:ca,v:cb,f:cc};};b9.OnLoad(function(){e.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
